function sskcheckMobile(){return null!=navigator.userAgent.match(/iPad/i)?!1:null!=navigator.userAgent.match(/iphone|android|phone|mobile|wap|netfront|x11|java|opera mobi|opera mini|ucweb|windows ce|symbian|symbianos|series|webos|sony|blackberry|dopod|nokia|samsung|palmsource|xda|pieplus|meizu|midp|cldc|motorola|foma|docomo|up.browser|up.link|blazer|helio|hosin|huawei|novarra|coolpad|webos|techfaith|palmsource|alcatel|amoi|ktouch|nexian|ericsson|philips|sagem|wellcom|bunjalloo|maui|smartphone|iemobile|spice|bird|zte-|longcos|pantech|gionee|portalmmm|jig browser|hiptop|benq|haier|^lct|320x320|240x320|176x220/i)?
!0:!1}
function sskua(h){var e;(e=h.match(/FireFox\/([^\s]+)/ig))?(e=e[0].split("/"),h='<span title="Firefox '+e[1]+'" class="ua_firefox"><i class="fa fa-firefox"></i>Firefox'):(e=h.match(/Maxthon([\d]*)\/([^\s]+)/ig))?(e[0].split("/"),h='<span title="Maxthon " class="ua_maxthon"><i class="fa fa-globe"></i>Maxthon'):(e=h.match(/BIDUBrowser([\d]*)\/([^\s]+)/ig))?(e=e[0].split("/"),h='<span title="\u767e\u5ea6\u6d4f\u89c8\u5668 '+e[1]+'" class="ua_ucweb"><i class="fa fa-globe"></i>BaiDu Browser'):(e=h.match(/UBrowser([\d]*)\/([^\s]+)/ig))?
(e=e[0].split("/"),h='<span title="UC\u6d4f\u89c8\u5668 '+e[1]+'" class="ua_ucweb"><i class="fa fa-globe"></i>UC Browser'):(e=h.match(/UCBrowser([\d]*)\/([^\s]+)/ig))?(e=e[0].split("/"),h='<span title="UC\u6d4f\u89c8\u5668 '+e[1]+'" class="ua_ucweb"><i class="fa fa-globe"></i>UC Browser '):h.match(/MetaSr/ig)?h='<span title="\u641c\u72d7\u6d4f\u89c8\u5668 " class="ua_sogou"><i class="fa fa-globe"></i>Sougou':h.match(/LBBROWSER/ig)?h='<span title="\u730e\u8c79\u6d4f\u89c8\u5668 " class="ua_lbbrowser"><i class="fa fa-globe"></i>Liebao':
(e=h.match(/MicroMessenger\/([^\s]+)/ig))?(e=e[0].split("/"),h='<span title="\u5fae\u4fe1 '+e[1]+'" class="ua_qq"><i class="fa fa-weixin"></i>Wechat'):(e=h.match(/QQBrowser\/([^\s]+)/ig))?(e=e[0].split("/"),h='<span title="QQ\u6d4f\u89c8\u5668 '+e[1]+'" class="ua_qq"><i class="fa fa-globe"></i>QQ Browser'):(e=h.match(/QQ\/([^\s]+)/ig))?(e=e[0].split("/"),h='<span title="QQ\u6d4f\u89c8\u5668 '+e[1]+'" class="ua_qq"><i class="fa fa-globe"></i>qq'):(e=h.match(/MiuiBrowser\/([^\s]+)/ig))?(e=e[0].split("/"),
h='<span title="Miui\u6d4f\u89c8\u5668 '+e[1]+'" class="ua_mi"><i class="fa fa-globe"></i>Miui'):(e=h.match(/Edge([\d]*)\/([^\s]+)/ig))?(e=e[0].split("/"),h='<span title="Edge '+e[1]+'" class="ua_ie"><i class="fa fa-edge"></i>Edge'):(e=h.match(/Chrome([\d]*)\/([^\s]+)/ig))?(e=e[0].split("/"),h='<span title="Chrome '+e[1]+'" class="ua_chrome"><i class="fa fa-chrome"></i>Chrome'):(e=h.match(/safari\/([^\s]+)/ig))?(e=e[0].split("/"),h='<span title="Safari '+e[1]+'" class="ua_apple"><i class="fa fa-safari"></i>Safari'):
(e=h.match(/Opera[\s|\/]([^\s]+)/ig))?(e[0].split("/"),h='<span title="Opera '+e[1]+'" class="ua_opera"><i class="fa fa-opera"></i>Opera'):h=h.match(/Trident\/7.0/gi)?'<span title="IE11 " class="ua_ie"><i class="fa fa-internet-explorer"></i>IE11':(e=h.match(/MSIE\s([^\s|;]+)/gi))?'<span title="IE '+e[0]+'" class="ua_ie"><i class="fa fa-internet-explorer"></i>IE':'<span title="\u5176\u4ed6\u6d4f\u89c8\u5668" class="ua_other"><i class="fa fa-globe"></i>Ua_others';sskcheckMobile();Mobile="";return h+
"</span>"+Mobile}
function sskos(h){return(h.match(/win/ig)?h.match(/nt 5.1/ig)?'<span title="windows XP" class="os_xp"><i class="fa fa-windows"></i>Win xp':h.match(/nt 6.1/ig)?'<span title="windows 7" class="os_7"><i class="fa fa-windows"></i>Win 7':h.match(/nt 6.2/ig)?'<span title="windows 8" class="os_8"><i class="fa fa-windows"></i>Win 8':h.match(/nt 6.3/ig)?'<span title="windows 8.1" class="os_8_1"><i class="fa fa-windows"></i>Win 8.1':h.match(/nt 10.0/ig)?'<span title="windows 10" class="os_8_1"><i class="fa fa-windows"></i>Win 10':h.match(/nt 6.0/ig)?
'<span title="windows Vista" class="os_vista"><i class="fa fa-windows"></i>Win vista':h.match(/nt 5/ig)?'<span title="windows 2000" class="os_2000"><i class="fa fa-windows"></i>Win 2000':'<span title="windows \u672a\u77e5" class="os_windows"><i class="fa fa-windows"></i>Win':h.match(/android/ig)?'<span title="Android" class="os_android"><i class="fa fa-android"></i>Android':h.match(/ubuntu/ig)?'<span title="Ubuntu" class="os_ubuntu"><i class="fa fa-desktop"></i>Ubuntu':h.match(/linux/ig)?'<span title="Linux" class="os_linux"><i class="fa fa-linux"></i>Linux':
h.match(/mac/ig)?'<span title="Mac OS X" class="os_mac"><i class="fa fa-apple"></i>Mac':h.match(/unix/ig)?'<span title="Unix" class="os_unix"><i class="fa fa-desktop"></i>Unix':h.match(/symbian/ig)?'<span title="Nokia SymbianOS" class="os_nokia"><i class="fa fa-mobile"></i>Nokia':'<span title="\u5176\u5b83\u64cd\u4f5c\u7cfb\u7edf" class="os_other"><i class="fa fa-desktop"></i>Os_others')+"</span>"}
!function(h,e,y){function z(){return n.short_name?T+"//"+n.short_name+"."+d.DOMAIN:d.REMOTE}function ya(){function a(){for(var a;a=ra.shift();){var f=a.url,d=new b(a.title,{dir:"auto",icon:a.iconUrl,body:a.body});try{d.onclick=function(){h.focus();P.href=f;d.close()}}catch(e){}setTimeout(function(){d.close&&d.close()},8E3)}}var b=h.Notification;"Notification"in h&&"denied"!==b.permission&&("granted"===b.permission&&a(),b.requestPermission(function(b){"granted"===b&&a()}))}function M(){return 0==u.data.user_id}
function sa(a){d.theme=a;"none"!=a&&p.injectStylesheet(d.STATIC_URL+"/styles/embed"+(a?"."+a+".css?"+za[a]:"."+short_name)+".css")}var p={},ta=e.getElementsByTagName("head")[0]||e.getElementsByTagName("body")[0];if(p.extend=function(a,b){for(var c in b)a[c]=b[c];return a},p.injectScript=function(a,b){var c=e.createElement("script"),f=e.head||e.getElementsByTagName("head")[0]||e.documentElement;c.type="text/javascript";c.src=a;c.async="async";c.charset="utf-8";b&&(c.onload=c.onreadystatechange=function(a,
d){(d||!c.readyState||/loaded|complete/.test(c.readyState))&&(c.onload=c.onreadystatechange=null,f&&c.parentNode&&f.removeChild(c),c=y,d||b.call(h))});f.insertBefore(c,f.firstChild)},p.injectStylesheet=function(a){var b=e.createElement("link");b.type="text/css";b.rel="stylesheet";b.href=a;ta.appendChild(b)},p.injectStyle=function(a){var b=e.createElement("style");return b.type="text/css",ta.appendChild(b),a=a.replace(/\}/g,"}\n"),b.styleSheet?b.styleSheet.cssText=a:b.appendChild(e.createTextNode(a)),
b},p.getCookie=function(a){var b,c,f;a=" "+a+"=";for(var d=e.cookie.split(";"),g=0;g<d.length;g++)if(b=" "+d[g],c=b.indexOf(a),0<=c&&c+a.length==(f=b.indexOf("=")+1))return decodeURIComponent(b.substring(f,b.length).replace(/\+/g,""));return y},p.param=function(a){var b=[],c;for(c in a)a[c]!=y&&b.push(c+"="+encodeURIComponent(a[c]));return b.join("&")},p.cssProperty=function(a,b){var c=(e.body||e.documentElement).style;if("undefined"==typeof c)return!1;if("string"==typeof c[a])return b?a:!0;var f=
["Moz","Webkit","ms"];a=a.charAt(0).toUpperCase()+a.substr(1);for(var d=0;d<f.length;d++)if("string"==typeof c[f[d]+a])return b?f[d]+a:!0},!h.DUOSHUO){for(var U in Object.prototype)return alert("Object.prototype \u4e0d\u4e3a\u7a7a\uff0c\u8bf7\u4e0d\u8981\u7ed9 Object.prototype \u8bbe\u7f6e\u65b9\u6cd5");var n,q,C=h.JSON,P=h.location,V=h.XMLHttpRequest,B=C&&C.stringify&&h.localStorage,ma=h.navigator.userAgent,T="https:"==e.location.protocol?"https:":"http:",W=0,ra=[],v=q=function(){function a(a){return b[a]||
"&amp;"}var b={"<":"<",">":">",'"':""","'":"'","`":"`"},c=/&(?!\w+;)|[<>"'`]/g,f=/[&<>"'`]/;return function(b){return null==b||!1===b?"":f.test(b)?b.replace(c,a):b}}(),Aa=function(a){if(a.match(/^(http|https):/))return a;var b=e.createElement("a");return b.href=a,F.hrefNormalized?b.href:b.getAttribute("href",4)};U=function(a){return function(){return a}};var I=function(){for(var a={},b=0;b<arguments.length;b++)arguments[b]&&p.extend(a,arguments[b]);return(a=p.param(a))?"?"+a:
""},X=function(){var a=p.getCookie("duoshuo_token");return a?{jwt:a}:n.remote_auth?{short_name:n.short_name,remote_auth:n.remote_auth}:y},na=function(){if(!n&&(n=h.duoshuoQuery)){if(!n.short_name||"your_duoshuo_short_name"===n.short_name)return n=y,void alert("\u4f60\u8fd8\u6ca1\u6709\u8bbe\u7f6e\u591a\u8bf4\u57df\u540d(duoshuoQuery.short_name)\uff0c\u586b\u5165\u5df2\u6709\u57df\u540d\u6216\u521b\u5efa\u65b0\u7ad9\u70b9\uff1ahttp://duoshuo.com/create-site/");ua.trigger("queryDefined")}return n},
D=function(a){return a&&a.error&&a.warn?a:{error:function(){},log:function(){},warn:function(){}}}(h.console),d=h.DUOSHUO={sourceName:{weibo:"\u65b0\u6d6a\u5fae\u535a",qq:"QQ",qzone:"QQ\u7a7a\u95f4",qqt:"\u817e\u8baf\u5fae\u535a",renren:"\u4eba\u4eba\u7f51",douban:"\u8c46\u74e3\u7f51",kaixin:"\u5f00\u5fc3\u7f51",sohu:"\u641c\u72d0\u5fae\u535a",baidu:"\u767e\u5ea6",google:"\u8c37\u6b4c",wechat:"\u5fae\u4fe1",weixin:"\u5fae\u4fe1",facebook:"Facebook",twitter:"Twitter",linkedin:"Linkedin"},serviceNames:{weibo:"\u5fae\u535a",
qq:"QQ",douban:"\u8c46\u74e3",renren:"\u4eba\u4eba",kaixin:"\u5f00\u5fc3",baidu:"\u767e\u5ea6",google:"\u8c37\u6b4c",wechat:"\u5fae\u4fe1",weixin:"\u5fae\u4fe1",facebook:"Facebook",twitter:"Twitter",linkedin:"Linkedin"},parseDate:function(a){return a.parse("2011-10-28T00:00:00+08:00")&&function(b){return new a(b)}||a.parse("2011/10/28T00:00:00+0800")&&function(b){return new a(b.replace(/-/g,"/").replace(/:(\d\d)$/,"$1"))}||a.parse("2011/10/28 00:00:00+0800")&&function(b){return new a(b.replace(/-/g,
"/").replace(/:(\d\d)$/,"$1").replace("T"," "))}||function(b){return new a(b)}}(Date),fullTime:function(a){a=d.parseDate(a);return a.getFullYear()+"\u5e74"+(a.getMonth()+1)+"\u6708"+a.getDate()+"\u65e5 "+a.toLocaleTimeString()},elapsedTime:function(a){a=d.parseDate(a);var b=new Date,c=(b-W-a)/1E3;return 10>c?"\u521a\u521a":60>c?Math.round(c)+"\u79d2\u524d":3600>c?Math.round(c/60)+"\u5206\u949f\u524d":86400>c?Math.round(c/3600)+"\u5c0f\u65f6\u524d":(b.getFullYear()==a.getFullYear()?"":a.getFullYear()+
"\u5e74")+(a.getMonth()+1)+"\u6708"+a.getDate()+"\u65e5"},compileStyle:function(a){var b="",c={};if(c.textbox="#ds-thread #ds-reset .ds-replybox .ds-textarea-wrapper",!a)return b;for(var f in a)b+=c[f]+"{"+a[f]+"}\n";return b},init:function(a,b){a&&!ca[a]&&(ca[a]=b||{type:"EmbedThread"});d.initView&&d.initView()}},Ba=e.all,F=d.support=function(){var a=e.createElement("div");a.innerHTML='<a href="/a" style="opacity:.55;">a</a><input type="checkbox"/>';var b=a.getElementsByTagName("a")[0],b={placeholder:"placeholder"in
a.getElementsByTagName("input")[0],touch:"ontouchstart"in h||"onmsgesturechange"in h,opacity:/^0.55$/.test(b.style.opacity),hrefNormalized:"/a"===b.getAttribute("href"),iOS:ma.match(/ \((iPad|iPhone|iPod);( U;)? CPU( iPhone)? OS /),android:ma.match(/ \(Linux; U; Android /)};return b.ie6=!V&&"undefined"==typeof a.style.maxHeight,b.authInWin=h.postMessage&&800<h.screen.width&&!b.iOS&&!b.android&&P.origin,b}(),ca=d.selectors={".ds-thread":{type:"EmbedThread"},".ds-recent-comments":{type:"RecentComments"},
".ds-recent-visitors":{type:"RecentVisitors"},".ds-top-users":{type:"TopUsers"},".ds-top-threads":{type:"TopThreads"},".ds-login":{type:"LoginWidget"},".ds-thread-count":{type:"ThreadCount"},".ds-share":{type:"ShareWidget"}},Q=d.openDialog=function(a){return d.dialog!==y&&d.dialog.el.remove(),d.dialog=(new m.Dialog(g.dialog(a))).open()},va=d.smilies={};d.require=function(){function a(a){return d.STATIC_URL+"/libs/"+a+".js"+(wa[a]?"?"+wa[a]+".js":"")}var b={mzadxN:"undefined"!=typeof mzadxN};return"undefined"!=
typeof jQuery&&"1.5"<=jQuery.fn.jquery&&(b["embed.compat"]=!0,d.jQuery=h.jQuery),function(c,f){if("string"==typeof c)b[c]?f():p.injectScript(a(c),function(){b[c]=!0;f()});else if("object"==typeof c){var d,e=!0;for(d=0;d<c.length;d++)(function(g){b[c[d]]||(e=!1,p.injectScript(a(g),function(){b[g]=!0;for(var a=0;a<c.length;a++)if(!b[c[a]])return;f()}))})(c[d]);e&&f()}}}();for(var t=0,w="EmbedThread RecentComments RecentVisitors TopUsers TopThreads LoginWidget ThreadCount".split(" ");t<w.length;t++)d[w[t]]=
function(a){return function(b,c){c=c||{};c.type=a;b&&!ca[b]&&(ca[b]=c);d.initSelector&&d.initSelector(b,c)}}(w[t]),d["create"+w[t]]=function(a){return function(b,c){var f=e.createElement(b),g;for(g in c)f.setAttribute("data-"+g,c[g]);return d[a](f),f}}(w[t]);d.RecentCommentsWidget=d.RecentComments;var A=d.API={ajax:function(a,b,c,f,g){function e(a,b,c){var d,h;if(200<=a&&300>a||304===a)if(304===a)b="notmodified",h=!0;else try{d=C.parse(c),b="success",h=!0}catch(l){b="parsererror"}else{b&&!a||(b="error");
try{d=C.parse(c)}catch(l){b="parsererror"}}h?f&&f(d):"parseerror"===b?D.error("\u89e3\u6790\u9519\u8bef: "+c):(D.error("\u51fa\u9519\u5566("+d.code+"): "+d.errorMessage),g&&g(d),d.errorTrace&&D.error(d.errorTrace));(a=m.getResponseHeader("Date"))&&(W=new Date-new Date(a))}var h=p.getCookie("duoshuo_token");c=c||{};c.v=d.version;h?c.jwt=h:n.remote_auth&&(c.remote_auth=n.remote_auth);if(V&&C&&C.parse){var m=new V;if(m&&"withCredentials"in m){var l;return m.open(a,z()+"/api/"+b+".json"+("GET"==a?"?"+
p.param(c):""),!0),m.withCredentials=!0,m.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),m.send("GET"==a?null:p.param(c)),l=function(a,b){var c,f,d,g;try{if(l&&(b||4===m.readyState))if(l=y,b)4!==m.readyState&&m.abort();else{c=m.status;d=m.getAllResponseHeaders();try{g=m.responseText}catch(h){}try{f=m.statusText}catch(h){f=""}}}catch(h){b||e(-1,h)}g&&e(c,f,g,d)},void(4===m.readyState?l():m.onreadystatechange=l)}}"GET"!=a&&(c._method="POST");a="cb_"+Math.round(1E6*
Math.random());A[a]=function(a){switch(a.code){case 0:f&&f(a);break;default:g&&g(a),D.error("\u51fa\u9519\u5566("+a.code+"): "+a.errorMessage),a.errorTrace&&D.error(a.errorTrace)}};c.callback="DUOSHUO.API['"+a+"']";p.injectScript(z()+"/api/"+b+".jsonp?"+p.param(c))},get:function(a,b,c,f){return this.ajax("GET",a,b,c,f)},post:function(a,b,c,f){return this.ajax("POST",a,b,c,f)}},xa=d.ws={messages:[],send:function(a){if(!("WebSocket"in h&&C))return!1;var b=this;if(b.messages.push(C.stringify(a)),!b.webSocket){var c=
b.webSocket=new WebSocket("https:"===e.location.protocol?"wss://ws.duoshuo.com:8202/":"ws://ws.duoshuo.com:8201/");c.onopen=function(){var a;if(1===c.readyState)for(;a=b.messages.shift();)c.send(a)};c.onmessage=function(a){try{var b=C.parse(a.data)}catch(c){return}switch(b.type){case "post":for(var g=0;g<d.pagelets.length;g++)a=d.pagelets[g],a.threadId==b.thread_id&&a.onMessage(b);break;case "notification":ra.push(b),ya()}};h.addEventListener("beforeunload",function(){c.close()})}b.webSocket.onopen()}};
d.DOMAIN="duoshuo.com";d.STATIC_URL=T+"//static.duoshuo.com";d.REMOTE=T+"//duoshuo.com";d.version="16.6.16";var za={"default":"9b2a46a0",dark:"33f3a5ac",bluebox:"39a75d50",newhua:"706ba4eb",justflat:"9d72ec5a"},wa={"embed.compat":"24f8ca3f",smilies:"921e8eda"},l={post:"\u53d1\u5e03",posting:"\u6b63\u5728\u53d1\u5e03",settings:"\u8bbe\u7f6e",reply:"\u56de\u590d",like:"\u9876",repost:"\u8f6c\u53d1",report:"\u4e3e\u62a5","delete":"\u5220\u9664",reply_to:"\u56de\u590d ",reposts:"\u8f6c\u53d1",comments:"\u8bc4\u8bba",
floor:"\u697c",latest:"\u6700\u65b0",earliest:"\u6700\u65e9",hottest:"\u6700\u70ed",share_to:"\u5206\u4eab\u5230:",leave_a_message:"\u8bf4\u70b9\u4ec0\u4e48\u5427\u2026",no_comments_yet:"\u8fd8\u6ca1\u6709\u8bc4\u8bba\uff0c\u6c99\u53d1\u7b49\u4f60\u6765\u62a2",repost_reason:"\u8bf7\u8f93\u5165\u8f6c\u53d1\u7406\u7531",hot_posts_title:"\u88ab\u9876\u8d77\u6765\u7684\u8bc4\u8bba",comments_zero:"\u6682\u65e0\u8bc4\u8bba",comments_one:"1\u6761\u8bc4\u8bba",comments_multiple:"{num}\u6761\u8bc4\u8bba",
reposts_zero:"\u6682\u65e0\u8f6c\u53d1",reposts_one:"1\u6761\u8f6c\u53d1",reposts_multiple:"{num}\u6761\u8f6c\u53d1",weibo_reposts_zero:"\u6682\u65e0\u65b0\u6d6a\u5fae\u535a",weibo_reposts_one:"1\u6761\u65b0\u6d6a\u5fae\u535a",weibo_reposts_multiple:"{num}\u6761\u65b0\u6d6a\u5fae\u535a",qqt_reposts_zero:"\u6682\u65e0\u817e\u8baf\u5fae\u535a",qqt_reposts_one:"1\u6761\u817e\u8baf\u5fae\u535a",qqt_reposts_multiple:"{num}\u6761\u817e\u8baf\u5fae\u535a"},ga={get:function(a){return B?B[a]:void 0},save:function(a,
b){if(B)try{B.removeItem(a),B[a]=C.stringify(b),B.removeItem(a+":timestamp"),B[a+":timestamp"]=Math.floor((new Date-W)/1E3)}catch(c){}}},ha=d.loadRequire=function(a){if(a.visitor&&(!u.data&&a.visitor.user_id&&h.Notification&&xa.send({logged_user_id:a.visitor.user_id}),u.reset(a.visitor)),a.site&&(R.reset(a.site),ga.save("ds_site_"+n.short_name,a.site)),!d.theme&&R.data.theme&&sa(R.data.theme),a.lang&&(p.extend(l,a.lang),ga.save("ds_lang_"+n.short_name,a.lang)),a.stylesheets)for(var b=0;b<a.stylesheets.length;b++)p.injectStylesheet(a.stylesheets[b]);
if(a.nonce&&(d.nonce=a.nonce),a.style&&p.injectStyle((a.style||"")+d.compileStyle(n.component_style)),a.unread&&J.reset(a.unread),a.warnings)for(b=0;b<a.warnings.length;b++)D.warn(a.warnings[b])},S=0,t=d.Class=function(){};t.extend=function(a){function b(){!S&&this.init&&this.init.apply(this,arguments)}S=1;var c=new this;S=0;for(var f in a)c[f]=a[f];return b.prototype=c,b.prototype.constructor=b,b.extend=arguments.callee,b};var ia=d.Event=t.extend({on:function(a,b){var c=this.handlers||(this.handlers=
{});return c[a]===y&&(c[a]=[]),c[a].push(b),this},trigger:function(a,b){var c=(this.handlers||(this.handlers={}))[a];if(c)for(var f=0;f<c.length&&!1!==c[f].call(this,b);f++);return this}}),G=d.Widget=ia.extend({init:function(a,b){this.el=a;this.options=b||{};this.render()},render:function(){},reset:function(){},load:function(a){switch(a.code){case 0:ha(a);var b=this.prepare(a);b.options=p.extend(this.options,a.options);this.onload(b);break;default:this.onError(a)}},onload:function(a){this.el.html(g[this.tmpl](a))},
prepare:function(a){return a},onMessage:function(){},onError:function(a){D.error("\u51fa\u9519\u5566("+a.code+"): "+a.errorMessage);a.errorTrace&&D.error(a.errorTrace)}}),t=d.Model=ia.extend({init:function(a){this.data=a},reset:function(a){this.data=a;this.trigger("reset")},remove:function(a){this.data.splice(a,1);this.trigger("reset")},set:function(a,b){if(b===y)for(var c in a)this.data[c]=a[c];else this.data[a]=b;return this.trigger("reset"),this},toJSON:function(){return p.extend({},this.data)}}),
oa=t.extend({toJSON:function(){return p.extend({},this.data)}}),ja=t.extend({toJSON:function(){var a=p.extend({},this.data);return a.theAuthor=K[this.data.author_id]&&K[this.data.author_id].data||this.data.author,a.parents=this.data.parents||[],a}}),pa=t.extend({toJSON:function(){return p.extend({},this.data)}}),w=function(a){this.model=a};w.prototype.set=function(a){for(var b in a)a[b]&&(this[b]?this[b].set(a[b]):this[b]=new this.model(a[b]))};w.prototype.get=function(a){for(var b=0,c=[];b<a.length;b++)c[b]=
this[a[b]];return c};w.prototype.getJSON=function(a){for(var b=0,c=[];b<a.length;b++)this[a[b]]&&c.push(this[a[b]].toJSON());return c};var E={userUrl:function(a){return a.url},avatarUrl:function(a){return a.avatar_url||R.data.default_avatar_url},loginUrl:function(a,b){return b||(b={}),n.sso&&n.sso.login&&(b.sso=1,b.redirect_uri=n.sso.login),z()+"/login/"+a+"/"+I(b)},bindUrl:function(a){return z()+"/bind/"+a+"/"+I(n.sso&&n.sso.login?{sso:1,redirect_uri:n.sso.login}:null,X())},logoutUrl:function(){return z()+
"/logout/"+I(n.sso&&n.sso.logout?{sso:1,redirect_uri:n.sso.logout}:null)}},Y=["weixin","weibo","qq","renren"],Z=["douban","kaixin","baidu","google"],g=d.templates={userAnchor:function(a){return a.url?'<a rel="nofollow author" target="_blank" href="'+v(a.url)+'">'+v(a.name)+"</a>":v(a.name)},avatarImg:function(a,b){return'<img src="'+v(E.avatarUrl(a,b))+'" alt="'+v(a.name)+'"'+(b?' style="width:'+b+"px;height:"+b+'px"':"")+"/>"},avatar:function(a,b){var c=g.avatarImg(a,b),f=E.userUrl(a);return f?'<a rel="nofollow author" target="_blank" href="'+
v(f)+'" '+(a.user_id?" onclick=\"this.href='"+z()+"/user-url/?user_id="+a.user_id+"';\"":"")+' title="'+v(a.name)+'">'+c+"</a>":c},timeText:function(a){return a?'<span class="ds-time" datetime="'+a+'" title="'+d.fullTime(a)+'">'+d.elapsedTime(a)+"</span>":""},timeAnchor:function(a,b){return a?'<a href="'+b+'" target="_blank" rel="nofollow" class="ds-time" datetime="'+a+'" title="'+d.fullTime(a)+'">'+d.elapsedTime(a)+"</a>":""},serviceIcon:function(a,b){return'<a href="javascript:void(0)" class="ds-service-icon'+
(b?"-grey":"")+" ds-"+a+'" data-service="'+a+'" title="'+d.sourceName[a]+'"></a>'},poweredBy:function(a){return'<p class="ds-powered-by"><a href="http://duoshuo.com" target="_blank" rel="nofollow">'+v(a)+"</a></p>"},indicator:U('<div id="ds-indicator"></div>'),waitingImg:U('<div id="ds-waiting"></div>'),loginItem:function(a,b){return'<li>    <a href="'+E[b?"bindUrl":"loginUrl"](a)+'" rel="nofollow" class="ds-service-link ds-'+a+'">'+d.serviceNames[a]+(u.data.social_uid[a]?' <span class="ds-icon ds-icon-ok"></span>':
"")+"</a></li>"}},aa=function(a){var b=[],c;for(c in a)b.push('<input type="hidden" name="'+c+'" value="'+v(a[c])+'" />');return b.join("\n")};g.commentList=function(a){var b="",c=a.list;if(c)for(var f,d=-1,e=c.length-1;e>d;)f=c[d+=1],b+='<li class="ds-comment',a.options.show_avatars&&(b+=" ds-show-avatars"),b+='" data-post-id="'+f.post_id+'">',a.options.show_avatars&&(b+='<div class="ds-avatar">'+g.avatar(f.theAuthor,a.options.avatar_size)+"</div>"),b+='<div class="ds-meta">'+g.userAnchor(f.theAuthor),
a.options.show_time&&(b+=g.timeText(f.created_at)),b+="</div>",b+=a.options.show_title?'<div class="ds-thread-title">\u5728 <a href="'+q(f.thread.url)+'#comments">'+q(f.thread.title)+'</a> \u4e2d\u8bc4\u8bba</div><div class="ds-excerpt">'+f.message+"</div>":'<a class="ds-excerpt" title="'+f.thread.title+' \u4e2d\u7684\u8bc4\u8bba" href="'+q(f.thread.url)+'#comments">'+f.message+"</a>",b+="</li>";return b};g.ctxPost=function(a){var b="";return a.post&&(b+='<li class="ds-ctx-entry"',a.hidden&&(b+=' style="display:none"'),
b+=' data-post-id="'+a.post.post_id+'"><div class="ds-avatar">'+g.avatar(a.post.theAuthor||a.post.author)+'</div><div class="ds-ctx-body"><div class="ds-ctx-head">'+g.userAnchor(a.post.theAuthor||a.post.author)+g.timeAnchor(a.post.created_at,a.post.url),0<=a.index&&(b+='<div class="ds-ctx-nth" title="'+d.fullTime(a.post.created_at)+'">'+(a.index+1)+l.floor+"</div>"),b+='</div><div class="ds-ctx-content">'+a.post.message,0<=a.index&&(b+='\u3000\u3000\u3000\u3000\u3000\u3000\u3000<div class="ds-comment-actions',
0<a.post.vote&&(b+=" ds-post-liked"),b+='">'+g.likePost(a.post)+'<a class="ds-post-repost" href="javascript:void(0);"><span class="ds-icon ds-icon-share"></span>'+l.repost+'</a><a class="ds-post-reply" href="javascript:void(0);"><span class="ds-icon ds-icon-reply"></span>'+l.reply+"</a></div>"),b+="</div></div></li>"),b};g["dialog-anonymous"]=function(a){var b='<h2>\u793e\u4ea4\u5e10\u53f7\u767b\u5f55</h2><div class="ds-icons-32">',c=a.services;if(c)for(var f,g=-1,e=c.length-1;e>g;)f=c[g+=1],b+='<a class="ds-'+
f+'" href="'+E.loginUrl(f)+'">'+d.sourceName[f]+"</a>";return b+="</div>",a.options.deny_anonymous||(b+='<h2>\u4f5c\u4e3a\u6e38\u5ba2\u7559\u8a00</h2><form><div class="ds-control-group"><input type="text" name="author_name" id="ds-dialog-name" value="'+q(u.data.name)+'" required /><label for="ds-dialog-name">\u540d\u5b57(\u5fc5\u586b)</label></div>',a.options.require_guest_email&&(b+='<div class="ds-control-group"><input type="email" name="author_email" id="ds-dialog-email" value="'+q(u.data.email)+
'" required /><label for="ds-dialog-email">\u90ae\u7bb1(\u5fc5\u586b)</label></div>'),a.options.require_guest_url&&(b+='<div class="ds-control-group"><input type="url" name="author_url" id="ds-dialog-url" placeholder="http://" value="'+q(u.data.url)+'" /><label for="ds-dialog-url">\u7f51\u5740(\u53ef\u9009)</label></div>'),b+='<button type="submit">\u53d1\u5e03</button></form>'),b};g["dialog-ask-for-auth"]=function(){return'<h2>\u793e\u4ea4\u5e10\u53f7\u767b\u5f55</h2><ul class="ds-service-list">'+
g.serviceList(Y)+'</ul><ul class="ds-service-list ds-additional-services">'+g.serviceList(Z)+"</ul>"};g["dialog-bind-more"]=function(){return'<h2>\u7ed1\u5b9a\u66f4\u591a\u5e10\u53f7</h2><ul class="ds-service-list">'+g.serviceBindList(Y)+'</ul><ul class="ds-service-list ds-additional-services">'+g.serviceBindList(Z)+'</ul><div style="clear:both"></div>'};g["dialog-qrcode"]=function(a){return'<h2>\u5fae\u4fe1\u626b\u4e00\u626b\uff0c\u5206\u4eab\u5230\u670b\u53cb\u5708</h2><div class="ds-share-qrcode" style="text-align:center;"><img src="'+
a.qrcode_url+'" alt="'+a.url+'"></div>'};g["dialog-reposts"]=function(a){var b='<h2>\u8f6c\u53d1\u5230\u5fae\u535a</h2><div class="ds-quote"><strong>@'+q(a.post.theAuthor.name)+"</strong>: "+a.post.message+"</div><form>"+aa({post_id:a.post.post_id})+'<div class="ds-textarea-wrapper"><textarea name="message" title="Ctrl+Enter\u5feb\u6377\u63d0\u4ea4" placeholder="'+q(l.repost_reason)+'">'+q(a.repostMessage)+'</textarea><pre class="ds-hidden-text"></pre>';return b+='</div><div class="ds-actions">',
a.service?b+=aa({"service[]":a.service}):(b+='<label><input type="checkbox" name="service[]" value="weibo"',u.data.social_uid.weibo&&(b+=' checked="checked"'),b+=' /><span class="ds-service-icon ds-weibo"></span>\u65b0\u6d6a\u5fae\u535a</label><label><input type="checkbox" name="service[]" value="qqt"',u.data.social_uid.qq&&(b+=' checked="checked"'),b+=' /><span class="ds-service-icon ds-qqt"></span>\u817e\u8baf\u5fae\u535a</label>'),b+('<button type="submit">'+l.repost+"</button></div></form>")};
g.dialog=function(a){return'<div class="ds-dialog"><div class="ds-dialog-inner ds-rounded"><div class="ds-dialog-body">'+a+'</div><div class="ds-dialog-footer"><a href="http://duoshuo.com/" target="_blank" class="ds-logo"></a><span>\u793e\u4f1a\u5316\u8bc4\u8bba\u6846</span></div><a class="ds-dialog-close" href="javascript:void(0)" title="\u5173\u95ed"></a></div></div>'};g.hotPosts=function(a){var b='<div class="ds-header ds-gradient-bg">'+q(l.hot_posts_title)+"</div><ul>",c=a.list;if(c)for(var d,
e=-1,h=c.length-1;h>e;)d=c[e+=1],b+=g.post({post:d,options:a.options});return b+"</ul>"};g.likePost=function(a){var b='<a class="ds-post-likes" href="javascript:void(0);"><span class="ds-icon ds-icon-like"></span>'+l.like;return 0<a.likes&&(b+="("+a.likes+")"),b+"</a>"};g.likeTooltip=function(a){var b='<div class="ds-like-tooltip ds-rounded"><p>\u5f88\u9ad8\u5174\u4f60\u80fd\u559c\u6b22\uff0c\u5206\u4eab\u4e00\u4e0b\u5427\uff1a</p><ul>',c;for(c in a.services)b+='<li><a class="ds-share-to-'+c+" ds-service-link ds-"+
c+'" href="'+z()+"/share-proxy/?"+p.param({service:c,thread_id:a.thread_id})+'">'+a.services[c]+"</a></li>";return b+'</ul><p class="ds-like-tooltip-footer"><a class="ds-like-tooltip-close">\u7b97\u4e86</a></p></div>'};g.loginButtons=function(){return'<div class="ds-login-buttons"><p>\u793e\u4ea4\u5e10\u53f7\u767b\u5f55:</p><div class="ds-social-links"><ul class="ds-service-list">'+g.serviceList(Y)+'<li><a class="ds-more-services" href="javascript:void(0)">\u66f4\u591a\u00bb</a></li></ul><ul class="ds-service-list ds-additional-services">'+
g.serviceList(Z)+"</ul></div></div>"};g.loginWidget=function(a){var b='<div class="ds-icons-32">';if(a)for(var c,f=-1,g=a.length-1;g>f;)c=a[f+=1],b+='<a class="ds-'+c+'" href="'+E.loginUrl(c)+'">'+d.sourceName[c]+"</a>";return b+"</div>"};g.meta=function(a){var b='<div class="ds-meta"><a href="javascript:void(0)" class="ds-like-thread-button ds-rounded';return 0<a.user_vote&&(b+=" ds-thread-liked"),b+='"><span class="ds-icon ds-icon-heart"></span> <span class="ds-thread-like-text">',b+=0<a.user_vote?
"\u5df2\u559c\u6b22":"\u559c\u6b22",b+'</span><span class="ds-thread-cancel-like">\u53d6\u6d88\u559c\u6b22</span></a><span class="ds-like-panel"></span></div>'};g.notify=function(a){var b='<div id="ds-reset"><a class="ds-logo" href="http://duoshuo.com/" target="_blank" title="\u591a\u8bf4"></a><ul class="ds-notify-unread"><li';return a.comments||(b+=' style="display:none;"'),b+='><a data-type="unread-comments" href="javascript:void(0);">\u4f60\u6709'+a.comments+"\u6761\u65b0\u56de\u590d</a></li><li",
a.notifications||(b+=' style="display:none;"'),b+('><a data-type="unread-notifications" href="javascript:void(0);">\u4f60\u6709'+a.notifications+"\u6761\u7cfb\u7edf\u6d88\u606f</a></li></ul></div>")};g.post=function(a){var b="",c=a.post;a=a.options;var f=c.author;if(b+='<li class="ds-post" data-post-id="'+c.post_id+'"><div class="ds-post-self" data-post-id="'+c.post_id+'" data-thread-id="'+c.thread_id+'" data-root-id="'+c.root_id+'" data-source="'+c.source+'"><div class="ds-avatar"',f.user_id&&(b+=
' data-user-id="'+f.user_id+'"'),b+=">"+g.avatar(f),d.sourceName[c.source]&&(b+=g.serviceIcon(c.source)),b+='</div><div class="ds-comment-body"><div class="ds-comment-header">',f.url?(b+='<a class="ds-user-name ds-highlight" data-qqt-account="'+(f.qqt_account||"")+'" href="'+q(f.url)+'" ',f.user_id&&(b+=" onclick=\"this.href='"+z()+"/user-url/?user_id="+f.user_id+"';\""),b+=' rel="nofollow" target="_blank"',f.user_id&&(b+=' data-user-id="'+f.user_id+'"'),b+=">"+q(f.name)+"</a>"):(b+='<span class="ds-user-name"',
f.user_id&&(b+=' data-user-id="'+f.user_id+'"'),b+=' data-qqt-account="'+(f.qqt_account||"")+'">'+q(f.name)+"</span>"),b+='<div id="duoshuoua"><span id="liulanqi" class="ua">'+sskua(c.agent)+'</span><span id="xitonginfo" class="ua">'+sskos(c.agent)+"</span></div>",b+="</div>",1==a.max_depth&&a.show_context&&c.parents.length){var b=b+'<ol id="ds-ctx">',e=H.getJSON(c.parents);if(e)for(var h,f=-1,m=e.length-1;m>f;)h=e[f+=1],1==f&&2<c.parents.length&&(b+='<li class="ds-ctx-entry"><a href="javascript:void(0);" class="ds-expand">\u8fd8\u6709'+
(c.parents.length-2)+"\u6761\u8bc4\u8bba</a></li>"),b+=g.ctxPost({post:h,index:f,hidden:f&&f<c.parents.length-1});b+="</ol>"}e="";for(void 0!=window.devicePixelRatio&&1.49<=window.devicePixelRatio&&(e="@2x");f=c.message.match(/\#\s*<img[^\>]*?title=\"\[\s*(\u5475\u5475|\u54c8\u54c8|\u5410\u820c|\u592a\u5f00\u5fc3|\u7b11\u773c|\u82b1\u5fc3|\u5c0f\u4e56|\u4e56|\u6342\u5634\u7b11|\u6ed1\u7a3d|\u4f60\u61c2\u7684|\u4e0d\u9ad8\u5174|\u6012|\u6c57|\u9ed1\u7ebf|\u6cea|\u771f\u68d2|\u55b7|\u60ca\u54ed|\u9634\u9669|\u9119\u89c6|\u9177|\u554a|\u72c2\u6c57|what|\u7591\u95ee|\u9178\u723d|\u5440\u54a9\u7239|\u59d4\u5c48|\u60ca\u8bb6|\u7761\u89c9|\u7b11\u5c3f|\u6316\u9f3b|\u5410|\u7280\u5229|\u5c0f\u7ea2\u8138|\u61d2\u5f97\u7406|\u52c9\u5f3a|\u7231\u5fc3|\u5fc3\u788e|\u73ab\u7470|\u793c\u7269|\u5f69\u8679|\u592a\u9633|\u661f\u661f\u6708\u4eae|\u94b1\u5e01|\u8336\u676f|\u86cb\u7cd5|\u5927\u62c7\u6307|\u80dc\u5229|haha|OK|\u6c99\u53d1|\u624b\u7eb8|\u9999\u8549|\u4fbf\u4fbf|\u836f\u4e38|\u7ea2\u9886\u5dfe|\u8721\u70db|\u97f3\u4e50|\u706f\u6ce1|\u5f00\u5fc3|\u94b1|\u54a6|\u547c|\u51b7|\u751f\u6c14|\u5f31|\u5410\u8840)\s*\]\"[^\>]*?class=\"ds\-smiley\"[^\>]*?>/);)c.message=
c.message.replace(f[0],'<img src="/usr/themes/Leaf/duoshuo/newpaopao/'+f[1].trim()+e+'.png" class="biaoqing paopao" height=30 width=30 no-zoom />');for(;f=c.message.match(/\#\[\s*(\u5475\u5475|\u54c8\u54c8|\u5410\u820c|\u592a\u5f00\u5fc3|\u7b11\u773c|\u82b1\u5fc3|\u5c0f\u4e56|\u4e56|\u6342\u5634\u7b11|\u6ed1\u7a3d|\u4f60\u61c2\u7684|\u4e0d\u9ad8\u5174|\u6012|\u6c57|\u9ed1\u7ebf|\u6cea|\u771f\u68d2|\u55b7|\u60ca\u54ed|\u9634\u9669|\u9119\u89c6|\u9177|\u554a|\u72c2\u6c57|what|\u7591\u95ee|\u9178\u723d|\u5440\u54a9\u7239|\u59d4\u5c48|\u60ca\u8bb6|\u7761\u89c9|\u7b11\u5c3f|\u6316\u9f3b|\u5410|\u7280\u5229|\u5c0f\u7ea2\u8138|\u61d2\u5f97\u7406|\u52c9\u5f3a|\u7231\u5fc3|\u5fc3\u788e|\u73ab\u7470|\u793c\u7269|\u5f69\u8679|\u592a\u9633|\u661f\u661f\u6708\u4eae|\u94b1\u5e01|\u8336\u676f|\u86cb\u7cd5|\u5927\u62c7\u6307|\u80dc\u5229|haha|OK|\u6c99\u53d1|\u624b\u7eb8|\u9999\u8549|\u4fbf\u4fbf|\u836f\u4e38|\u7ea2\u9886\u5dfe|\u8721\u70db|\u97f3\u4e50|\u706f\u6ce1|\u5f00\u5fc3|\u94b1|\u54a6|\u547c|\u51b7|\u751f\u6c14|\u5f31|\u5410\u8840)\s*\]/);)c.message=
c.message.replace(f[0],'<img src="/usr/themes/Leaf/duoshuo/newpaopao/'+f[1]+e+'.png" class="biaoqing paopao" height=30 width=30 no-zoom />');for(;f=c.message.match(/\#\(\s*(\u9ad8\u5174|\u5c0f\u6012|\u8138\u7ea2|\u5185\u4f24|\u88c5\u5927\u6b3e|\u8d5e\u4e00\u4e2a|\u5bb3\u7f9e|\u6c57|\u5410\u8840\u5012\u5730|\u6df1\u601d|\u4e0d\u9ad8\u5174|\u65e0\u8bed|\u4eb2\u4eb2|\u53e3\u6c34|\u5c34\u5c2c|\u4e2d\u6307|\u60f3\u4e00\u60f3|\u54ed\u6ce3|\u4fbf\u4fbf|\u732e\u82b1|\u76b1\u7709|\u50bb\u7b11|\u72c2\u6c57|\u5410|\u55b7\u6c34|\u770b\u4e0d\u89c1|\u9f13\u638c|\u9634\u6697|\u957f\u8349|\u732e\u9ec4\u74dc|\u90aa\u6076|\u671f\u5f85|\u5f97\u610f|\u5410\u820c|\u55b7\u8840|\u65e0\u6240\u8c13|\u89c2\u5bdf|\u6697\u5730\u89c2\u5bdf|\u80bf\u5305|\u4e2d\u67aa|\u5927\u56e7|\u5472\u7259|\u62a0\u9f3b|\u4e0d\u8bf4\u8bdd|\u54bd\u6c14|\u6b22\u547c|\u9501\u7709|\u8721\u70db|\u5750\u7b49|\u51fb\u638c|\u60ca\u559c|\u559c\u6781\u800c\u6ce3|\u62bd\u70df|\u4e0d\u51fa\u6240\u6599|\u6124\u6012|\u65e0\u5948|\u9ed1\u7ebf|\u6295\u964d|\u770b\u70ed\u95f9|\u6247\u8033\u5149|\u5c0f\u773c\u775b|\u4e2d\u5200)\s*\)/);)c.message=
c.message.replace(f[0],'<img src="/usr/themes/Leaf/duoshuo/alu/'+f[1]+e+'.png" class="biaoqing alu" height=33 width=33 no-zoom />');if(b+="<p>",c.parents.length>=a.max_depth&&(!a.show_context||1<a.max_depth)&&c.parent_id&&H[c.parent_id]&&(b+='<a class="ds-comment-context" data-post-id="'+c.post_id+'" data-parent-id="'+c.parent_id+'">'+l.reply_to+q(H[c.parent_id].toJSON().author.name)+": </a>"),b+=c.message+'</p><div class="ds-comment-footer ds-comment-actions',0<c.vote&&(b+=" ds-post-liked"),
b+='">',b+=c.url?g.timeAnchor(c.created_at,c.url):g.timeText(c.created_at),"duoshuo"==c.source?(b+='<a class="ds-post-reply" href="javascript:void(0);"><span class="ds-icon ds-icon-reply"></span>'+l.reply+"</a>"+g.likePost(c)+'<a class="ds-post-repost" href="javascript:void(0);"><span class="ds-icon ds-icon-share"></span>'+l.repost+'</a><a class="ds-post-report" href="javascript:void(0);"><span class="ds-icon ds-icon-report"></span>'+l.report+"</a>",c.privileges["delete"]&&(b+='<a class="ds-post-delete" href="javascript:void(0);"><span class="ds-icon ds-icon-delete"></span>'+
l["delete"]+"</a>")):("qqt"==c.source||"weibo"==c.source)&&(b+='<a class="ds-weibo-comments" href="javascript:void(0);">'+l.comments,c.type.match(/\-comment$/)||(b+='(<span class="ds-count">'+c.comments+"</span>)"),b+='</a><a class="ds-weibo-reposts" href="javascript:void(0);">'+l.reposts,c.type.match(/\-comment$/)||(b+='(<span class="ds-count">'+c.reposts+"</span>)"),b+="</a>"),b+="</div></div></div>",1<a.max_depth&&(c.childrenArray||c.children)&&"weibo"!=c.source&&"qqt"!=c.source){b+='<ul class="ds-children">';
if(e=H.getJSON(c.childrenArray||c.children))for(f=-1,h=e.length-1;h>f;)c=e[f+=1],b+=g.post({post:c,options:a});b+="</ul>"}return b+"</li>"};g.postListHead=function(a){var b='<div class="ds-comments-info"><div class="ds-sort"><a class="ds-order-desc">'+l.latest+'</a><a class="ds-order-asc">'+l.earliest+'</a><a class="ds-order-hot">'+l.hottest+'</a></div><ul class="ds-comments-tabs"><li class="ds-tab"><a class="ds-comments-tab-duoshuo ds-current" href="javascript:void(0);"></a></li>';return a.options.show_reposts&&
a.thread.reposts&&(b+='<li class="ds-tab"><a class="ds-comments-tab-repost" href="javascript:void(0);"></a></li>'),b+=" ",a.options.show_weibo&&a.thread.weibo_reposts&&(b+='<li class="ds-tab"><a class="ds-comments-tab-weibo" href="javascript:void(0);"></a></li>'),b+=" ",a.options.show_qqt&&a.thread.qqt_reposts&&(b+='<li class="ds-tab"><a class="ds-comments-tab-qqt" href="javascript:void(0);"></a></li>'),b+"</ul></div>"};g.recentVisitors=function(a){var b="",c=a.response;if(c)for(var d,e=-1,h=c.length-
1;h>e;)d=c[e+=1],b+='<div class="ds-avatar">'+g.avatar(d,a.options.avatar_size)+"</div>";return b};g["related-read"]=function(a){var b="";if(a&&a.length){b+='<article class="ds-reads-expand"><div class="ds-header">\u5934\u6761\u63a8\u8350</div><section> ';if(a)for(var c,d=-1,e=a.length-1;e>d;){if(c=a[d+=1],b+=' <a href="'+c.url+'" class="ds-reads-item"> ',3==c.imgs.length){var b=b+(" <h2>"+c.title+'</h2> <div class="ds-reads-pics"> <ul> '),g=c.imgs;if(g)for(var h,m=-1,l=g.length-1;l>m;)h=g[m+=1],
b+=' <li> <div class="ds-reads-dumb"></div> <div class="ds-reads-pic-wrap" style="background-image:url('+h+');"></div> </li> ';b+=' </ul> </div> <div class="ds-reads-info"> ';1==c.type&&(b+=' <span class="ds-reads-app-special">\u6253\u5f00\u5934\u6761\u9605\u8bfb</span> ');b+=' <span class="ds-reads-date" data-date="'+c.timeStamp+'"></span> </div> '}else b+=' <div class="ds-reads-desc ',c.imgs.length||(b+="ds-reads-only"),b+='"> <div class="ds-reads-title">'+c.title+'</div> <div class="ds-reads-info"> ',
1==c.type&&(b+=' <span class="ds-reads-app-special">\u6253\u5f00\u5934\u6761\u9605\u8bfb</span> '),b+=' <span class="ds-reads-date" data-date="'+c.timeStamp+'"></span> </div> </div> ',c.imgs.length&&(b+=' <div class="ds-reads-pic-right"> <div class="ds-reads-dumb"></div> <div class="ds-reads-pic-wrap" style="background-image:url('+c.imgs[0]+');"> ',c.hasVideo&&(b+=' <div class="ds-reads-vid-info"><span>'+c.videoDuration+"</span></div> "),b+=" </div> </div> "),b+=" ";b+=" </a> "}b+="</section></article>"}return b};
g.replybox=function(a){var b='<div class="ds-replybox"><a class="ds-avatar"';if(b+=M()?' href="javascript:void(0);" onclick="return false"':' href="'+d.REMOTE+"/settings/avatar/"+I(X())+'" target="_blank" title="\u8bbe\u7f6e\u5934\u50cf"',b+=">"+g.avatarImg(u.data)+'</a><form id="commenthw" method="post">'+aa(a.params)+'<div class="ds-textarea-wrapper ds-rounded-top"><textarea name="message" title="Ctrl+Enter\u5feb\u6377\u63d0\u4ea4" placeholder="'+q(l.leave_a_message)+'"></textarea><pre class="ds-hidden-text"></pre>',
b+="</div>",b+='<div class="ds-post-toolbar"><div class="ds-post-options ds-gradient-bg"><span class="ds-sync">',!M()&&u.data.repostOptions){b+='<input id="ds-sync-checkbox';a.inline&&(b+="-inline");b+='" type="checkbox" name="repost" ';a.checked&&(b+='checked="checked" ');b+='value="'+a.repostArray.join(",")+'"> <label for="ds-sync-checkbox';a.inline&&(b+="-inline");var b=b+('">'+l.share_to+"</label>"),c;for(c in u.data.repostOptions)b+=g.serviceIcon(c,!u.data.repostOptions[c])}return b+="</span>",
b+="</div>",b+='<button class="ds-post-button" type="submit">'+q(l.post)+'</button><div class="ds-toolbar-buttons">',a.options.use_smilies&&(b+='<a class="ds-toolbar-button ds-add-emote" title="\u63d2\u5165\u8868\u60c5"></a>'),a.options.use_images&&a.options.parse_html_enabled&&(b+='<a class="ds-toolbar-button ds-add-image" title="\u63d2\u5165\u56fe\u7247"></a>'),b+="</div></div>",b+"</form></div>"};g.serviceBindList=function(a){var b="";if(a)for(var c,f=-1,e=a.length-1;e>f;)c=a[f+=1],b+='<li><a href="'+
E.bindUrl(c)+'" rel="nofollow" class="ds-service-link ds-'+c+'">'+d.serviceNames[c],u.data.social_uid[c]&&(b+=' <span class="ds-icon ds-icon-ok"></span>'),b+="</a></li>";return b};g.serviceList=function(a){var b="";if(a)for(var c,f=-1,e=a.length-1;e>f;)c=a[f+=1],b+='<li><a href="'+E.loginUrl(c)+'" rel="nofollow" class="ds-service-link ds-'+c+'">'+d.serviceNames[c]+"</a></li>";return b};g.shareWidget=function(a){var b='<div class="ds-share-icons"> <div class="ds-share-icons-inner"> <ul class="ds-share-icons-16"> ',
c=a.services;if(c)for(var e,g=-1,h=c.length-1;h>g;)e=c[g+=1],b+=' <li> <a class="ds-'+e+'" href="javascript:void(0);" data-service="'+e+'">'+d.sourceName[e]+"</a> </li> ";return b+(' </ul> </div> <div class="ds-share-icons-footer">'+a.copyright+"</div></div>")};g.smiliesTooltip=function(a){var b='<div id="ds-smilies-tooltip"><ul class="ds-smilies-tabs">',c;for(c in a)b+="<li><a>"+c+"</a></li>";return b+'</ul><div class="ds-smilies-container"></div></div>'};g.toolbar=function(){var a='<div class="ds-toolbar"><div class="ds-account-control"><span class="ds-icon ds-icon-settings"></span> <span>\u5e10\u53f7\u7ba1\u7406</span><ul><li><a class="ds-bind-more" href="javascript:void(0);" style="border-top: none">\u7ed1\u5b9a\u66f4\u591a</a></li><li><a target="_blank" href="'+
d.REMOTE+"/settings/"+I(X())+'">'+q(l.settings)+'</a></li><li><a rel="nofollow" href="'+E.logoutUrl()+'" style="border-bottom: none">\u767b\u51fa</a></li></ul></div><div class="ds-visitor">';return a+=u.data.url?'<a class="ds-visitor-name" href="'+q(u.data.url)+'" target="_blank">'+q(u.data.name)+"</a>":'<span class="ds-visitor-name">'+q(u.data.name)+"</span>",a+'<a class="ds-unread-comments-count" href="javascript:void(0);" title="\u65b0\u56de\u590d"></a></div></div>'};g.topThreads=function(a){var b=
"";if(a=a.response)for(var c,d=-1,e=a.length-1;e>d;)c=a[d+=1],b+='<li><a target="_blank" href="'+q(c.url)+'" title="'+q(c.title)+'">'+q(c.title)+"</a></li>";return b};g.topUsers=function(a){var b="",c=a.response;if(c)for(var d,e=-1,h=c.length-1;h>e;)d=c[e+=1],b+='<div class="ds-avatar">'+g.avatar(d,a.options.avatar_size)+"<h4>"+q(d.name)+"</h4></div>";return b};g.userInfo=function(a){var b='<a href="'+q(a.url)+'" onclick="this.href=\''+z()+"/user-url/?user_id="+a.user_id+'\';" class="ds-avatar" target="_blank">'+
g.avatarImg(a)+'</a><a href="'+q(a.url)+'" onclick="this.href=\''+z()+"/user-url/?user_id="+a.user_id+'\';" class="ds-user-name ds-highlight" target="_blank">'+q(a.name)+"</a>",c;for(c in a.social_uid)b+='<a href="'+d.REMOTE+"/user-proxy/"+c+"/"+a.social_uid[c]+'/" target="_blank" class="ds-service-icon ds-'+c+'" title="'+d.sourceName[c]+'"></a>';return b+='<p class="ds-user-card-meta"><a href="'+d.REMOTE+"/profile/"+a.user_id+'/" target="_blank"><span class="ds-highlight">'+a.comments+"</span>\u6761\u8bc4\u8bba</a></p>",
a.description&&(b+='<p class="ds-user-description">'+q(a.description)+"</p>"),b};var m=d.Views={},Ca=(d.Callbacks={},d.pagelets=[]),ua=d.events=new ia,R=d.site=new t,u=d.visitor=new oa,J=d.unread=new t,ka=d.threadPool=new w(pa),H=d.postPool=new w(ja),K=d.userPool=new w(oa);ua.on("queryDefined",function(){var a=n.short_name;if(n.theme&&sa(n.theme),B){var b=B["ds_site_"+a],a=B["ds_lang_"+a];b&&R.reset(C.parse(b));a&&p.extend(l,C.parse(a))}});na();d.require("embed.compat",function(){function a(a){a.stopPropagation()}
function b(a){(a.ctrlKey&&13==a.which||10==a.which)&&k(this.form).trigger("submit")}function c(){var a=k(this);a.height(Math.max(54,a.next(".ds-hidden-text").text(this.value).height()+27))}function f(){if(F.authInWin){var a=this.href.match(/\/(login|bind)\/(\w+)\//i);if(a&&d.serviceNames[a[2]])return!I(a[2],this.href)}}function q(){var a,b,c,d,g,f=0,h=0;e.selection&&(b=e.selection.createRange(),b&&b.parentElement()==this&&(d=this.value.length,a=this.value.replace(/\r\n/g,"\n"),c=this.createTextRange(),
c.moveToBookmark(b.getBookmark()),g=this.createTextRange(),g.collapse(!1),-1<c.compareEndPoints("StartToEnd",g)?f=h=d:(f=-c.moveStart("character",-d),f+=a.slice(0,f).split("\n").length-1,-1<c.compareEndPoints("EndToEnd",g)?h=d:(h=-c.moveEnd("character",-d),h+=a.slice(0,h).split("\n").length-1))));k(this).data("ds-range-start",f).data("ds-range-end",h)}function t(a){return F.touch&&a.addClass("ds-touch"),p.cssProperty("transition")||a.addClass("ds-no-transition"),F.ie6&&a.addClass("ds-ie6"),F.opacity||
a.addClass("ds-no-opacity"),a}function C(a){if(!F.placeholder){var b=a.attr("placeholder");a.val(b).focus(function(){this.value===b&&(this.value="")}).blur(function(){""===this.value&&(this.value=b)})}return a}function w(a){if("http://duoshuo.com"===a.origin)switch(a.data.type){case "login":P.href=a.data.redirectUrl}}function I(a,b){var c={weibo:[760,600],renren:[420,322],qq:[504,445],weixin:[450,550],google:[600,440]}[a]||[550,400];return h.open(b+(-1==b.indexOf("?")?"?":"&")+p.param({origin:P.origin||
"http://"+P.host}),"_blank","width="+c[0]+",height="+c[1]+",toolbar=no,menubar=no,location=yes")}function T(a){var b=E[M()?"loginUrl":"bindUrl"](a);F.authInWin&&I(a,b)||(P.href=b)}function U(a,e,f,h){var x=Q(g["dialog-reposts"]({post:a.toJSON(),repostMessage:e,service:h})),r=x.el.find("form");return r.submit(function(){function a(b){if(f&&h){var c=f.options;b=S(f.postList.el,b.response[h],c);"asc"==c.order==("top"==c.formPosition)&&d.scrollTo(b);c=f.el.find(".ds-comments-tab-"+h+" span.ds-highlight");
c.html(parseInt(c.html())+1)}}return h||r.find("[type=checkbox]:checked")[0]?(A.post("posts/repost",d.toJSON(r),a),x.close(),!1):(alert("\u8fd8\u6ca1\u6709\u9009\u53d1\u5e03\u5230\u54ea\u513f\u5462"),!1)}),r.find(".ds-actions [type=checkbox]").change(function(){var a=this.value;return this.checked&&!u.data.social_uid["qqt"==a?"qq":a]?void T(a):void 0}),C(r.find("textarea")).keyup(b).keyup(c).focus(),!1}function V(a){var b={"unread-comments":{title:"\u65b0\u7559\u8a00\u53ca\u56de\u590d",apiUrl:"users/unreadComments",
tmpl:function(a){return a.thread?'<li data-thread-id="'+a.thread.thread_id+'">'+k.map(a.authors,g.userAnchor).join("\u3001")+' \u5728 <a class="ds-read" href="'+a.thread.url+'#comments" target="_blank">'+v(a.thread.title||"\u65e0\u6807\u9898")+'</a> \u4e2d\u56de\u590d\u4e86\u4f60 <a class="ds-delete ds-read" title="\u77e5\u9053\u4e86" href="javascript:void(0)">\u77e5\u9053\u4e86</a></li>':""},read:function(a){a=a.attr("data-thread-id");A.post("threads/read",{thread_id:a});J.data.comments--}},"unread-notifications":{title:"\u7cfb\u7edf\u6d88\u606f",
apiUrl:"users/unreadNotifications",tmpl:function(a){return'<li data-notification-id="'+a.notification_id+'" data-notification-type="'+a.type+'">'+a.content+' <a class="ds-delete ds-read" title="\u77e5\u9053\u4e86" href="javascript:void(0)">\u77e5\u9053\u4e86</a></li>'},read:function(a){a=a.attr("data-notification-id");A.post("notifications/read",{notification_id:a});J.data.notifications--}}}[a],c=Q("<h2>"+b.title+'</h2><ul class="ds-unread-list"></ul>');c.on("close",d.resetNotify);var e=c.el.find(".ds-unread-list").delegate(".ds-delete",
"click",function(){return k(this).parent().remove(),0===e.children().length&&c.close(),!1}).delegate(".ds-read","click",function(){b.read(k(this).parent())});k("#ds-notify").hide();A.get(b.apiUrl,{},function(a){c.el.find(".ds-unread-list").html(k.map(a.response,b.tmpl).join("\n"))})}function W(){bubbleOutTimer&&(clearTimeout(bubbleOutTimer),bubbleOutTimer=0)}function X(){bubbleOutTimer=setTimeout(function(){bubbleOutTimer=0;O.detach()},400)}function S(a,b,c){return a.find(".ds-post[data-post-id="+
b.data.post_id+"]")[0]?void 0:(a.find(".ds-post-placeholder").remove(),k(g.post({post:b.toJSON(),options:c})).hide()["asc"==c.order?"appendTo":"prependTo"](a).slideDown(function(){}))}function Y(a,b){function c(){var b=this;if(bubbleOutTimer&&O.owner==b)return clearTimeout(bubbleOutTimer),void(bubbleOutTimer=0);var d=k(b);da=setTimeout(function(){function c(a){a=a.response;K[k]?K[k].set(a):K[k]=new oa(a);O.owner==b&&ea.html(g.userInfo(a))}da=0;O.owner=b;W();var e=d.offset(),f=a.el.offset(),h=d.innerWidth()/
2,Da=a.el.innerHeight()-(e.top-f.top)+6,e=e.left-f.left-35+(35<h?35:h);try{if(d.hasClass("ds-comment-context"))ea.attr("id","ds-ctx-bubble").attr("data-post-id",d.attr("data-post-id")).html('<ul id="ds-ctx">'+g.ctxPost({post:H[d.attr("data-parent-id")].toJSON()})+'</ul><div class="ds-bubble-footer"><a class="ds-ctx-open" href="javascript:void(0);">\u67e5\u770b\u5bf9\u8bdd</a></div>');else if(d.hasClass("ds-avatar")||d.hasClass("ds-user-name")){var f={},k=f.user_id=d.attr("data-user-id");if(!k)throw"no info";
ea.attr("id","ds-user-card").attr("data-user-id",k).empty();K[k]?ea.html(g.userInfo(K[k].data)):A.get("users/profile",fa(f),c)}O.css({bottom:Da,left:e}).appendTo(a.innerEl)}catch(qa){O.detach()}},200)}function d(){da?(clearTimeout(da),da=0):bubbleOutTimer||X()}var e;this.delegate("a.ds-post-likes","click",function(){if(M())return Q(g["dialog-ask-for-auth"]({})).el.find(".ds-dialog").css("width","300px").find("a.ds-service-link").click(f),!1;var a=k(this).parent(),b=a.hasClass("ds-post-liked"),c=k(this).html().match(/\((\d+)\)/),
c=(c?parseInt(c[1]):0)+(b?-1:1);return A.post("posts/vote",{post_id:a.closest(".ds-ctx-entry, .ds-post-self").attr("data-post-id"),vote:b?0:1}),k(this).html(k(this).html().replace(/\(\d+\)/,"")+(c?"("+c+")":"")),a[b?"removeClass":"addClass"]("ds-post-liked"),!1}).delegate("a.ds-post-repost","click",function(){var a=k(this).closest(".ds-post-self"),a=H[a.attr("data-post-id")];return U(a,""),!1}).delegate("a.ds-post-delete","click",function(){if(!confirm("\u786e\u5b9a\u8981\u5220\u9664\u8fd9\u6761\u8bc4\u8bba\u5417\uff1f"))return!1;
var b=k(this).closest(".ds-post-self");return A.post("posts/remove",{post_id:b.attr("data-post-id")}),b.parent().fadeOut(200,function(){a.data.comments--;a.updateCounter("duoshuo");k(this).remove()}),!1}).delegate("a.ds-post-report","click",function(){if(!confirm("\u786e\u5b9a\u8981\u4e3e\u62a5\u8fd9\u6761\u8bc4\u8bba\u5417\uff1f"))return!1;var a=k(this).closest(".ds-post-self");return A.post("posts/report",{post_id:a.attr("data-post-id")}),alert("\u611f\u8c22\u60a8\u7684\u53cd\u9988\uff01"),!1}).delegate("a.ds-post-reply",
"click",function(){var c=k(this),d=c.closest(".ds-comment-actions");if(d.hasClass("ds-reply-active"))e.el.fadeOut(200,function(){k(this).detach()}),d.removeClass("ds-reply-active");else{var f=c.closest(".ds-ctx-entry, .ds-post-self");e?e.actionsBar.removeClass("ds-reply-active"):(e=new m.Replybox(a),e.render(!0).el.addClass("ds-inline-replybox").detach());e.el.find("[name=parent_id]").val(f.attr("data-post-id"));e.el.show().appendTo(c.closest(".ds-ctx-body, .ds-comment-body")).find("textarea").focus();
e.actionsBar=d.addClass("ds-reply-active");1>=b.max_depth?e.postList=a.postList.el:(e.postList=f.siblings(".ds-children"),e.postList[0]||(e.postList=k('<ul class="ds-children"></ul>').insertAfter(f)))}return!1}).delegate("a.ds-weibo-comments","click",function(){function a(c){ha(c);d.append(k.map(c.response,function(a){return g.post({post:a,options:b})}).join(""))}var c=k(this).closest(".ds-post-self"),ba=c.attr("data-post-id");c.data("source");if(0!=c.attr("data-root-id"))return!1;var d=c.siblings(".ds-children");
return d[0]?(d.remove(),!1):(d=k('<ul class="ds-children"></ul>').insertAfter(c),A.get("posts/listComments",fa({post_id:ba}),a),!1)}).delegate("a.ds-weibo-reposts","click",function(){var b=k(this).closest(".ds-post-self"),b=H[b.attr("data-post-id")],c=b.data.source;if(!u.data.social_uid["qqt"==c?"qq":c])return void T(c);var d=b.data.root_id,e="0"!=d?H[d]:b,f="";"0"!=d&&(d=prepatePost(b.data).theAuthor,f=("weibo"==c?"//@"+d.name:"|| @"+d.qqt_account)+":"+b.data.message);return U(e,f,a,c),!1}).delegate("a.ds-expand",
"click",function(){var a=k(this).parent();return a.siblings().show(),a.remove(),!1});F.touch||this.delegate("a.ds-comment-context, .ds-avatar, .ds-user-name","mouseenter",c).delegate("a.ds-comment-context, .ds-avatar, .ds-user-name","mouseleave",d)}function fa(a){var b={require:"site,visitor,nonce,lang"+(aa++?"":",unread,log,extraCss"),site_ims:ga.get("ds_site_"+n.short_name+":timestamp"),lang_ims:ga.get("ds_lang_"+n.short_name+":timestamp"),referer:e.referrer};n.stylePatch&&(b.style_patch=n.stylePatch);
for(var c in b)b[c]&&(!F.ie6||200>encodeURIComponent(b[c]).length)&&(a[c]=b[c]);return a}var k=d.jQuery,la=k(h),Z=k(e);h.postMessage&&(h.addEventListener?h.addEventListener("message",w,!1):h.attachEvent&&h.attachEvent("onmessage",w));d.scrollTo=function(a){a=a.offset().top;(a<la.scrollTop()||a>la.scrollTop()+la.height())&&k("html, body").animate({scrollTop:a-40},200,"swing")};d.toJSON=function(a){var b=/\r?\n/g,c=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,
d=/^(?:select|textarea)/i;a=a.map(function(){return this.elements?k.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||d.test(this.nodeName)||c.test(this.type))}).map(function(a,c){var d=k(this).val();return null==d?null:k.isArray(d)?k.map(d,function(a){return{name:c.name,value:a.replace(b,"\r\n")}}):{name:c.name,value:d.replace(b,"\r\n")}}).toArray();var e={};return k.each(a,function(){e[this.name]=this.value}),e};d.resetNotify=function(){var a=k("#ds-notify"),
b=J.data;a[0]||(a=k('<div id="ds-notify"></div>').css({hidden:{display:"none"},"top-right":{top:"24px",right:"24px"},"bottom-right":{bottom:"24px",right:"24px"}}[R.data.notify_position]).delegate(".ds-notify-unread a","click",function(){return V(k(this).data("type")),!1}).appendTo(e.body));a.html(g.notify(b))[!b.comments&&!b.notifications||"hidden"===R.data.notify_position||k(".ds-dialog")[0]?"hide":"show"]()};J.on("reset",d.resetNotify);m.Replybox=function(a){this.embedThread=a};m.Replybox.prototype=
{render:function(a){function h(a){a.data("submitting",!0);a.find(".ds-post-button").addClass("ds-waiting").html(l.posting)[0].disabled=!0}function qa(a){a.data("submitting",!1);a.find(".ds-post-button").removeClass("ds-waiting").html(l.post)[0].disabled=!1}var N=this,x=N.embedThread,r=x.options,n=function(){d.require("smilies",function(){})},p={thread:x,options:r,inline:a,params:{thread_id:x.threadId,parent_id:"",nonce:d.nonce},repostArray:[],checked:0},t;for(t in u.data.repostOptions)u.data.repostOptions[t]&&
(p.repostArray.push(t),p.checked=1);var w=N.el=k(g.replybox(p)).click(n),L=w.find("form"),y=L.find("input[type=checkbox]")[0],z=L.find("a.ds-service-icon, a.ds-service-icon-grey"),v=C(L.find("textarea")).focus(n).keyup(b).keyup(c).bind("focus mousedown mouseup keyup",q),D=w.find(".ds-add-emote").click(function(a){var b=d.smiliesTooltip;return D.toggleClass("ds-expanded").hasClass("ds-expanded")?(b||(b=d.smiliesTooltip=new m.SmiliesTooltip,b.render(),DUOSHUO.addSmilies("\u6ce1\u6ce1",{"#[\u5475\u5475]":"newpaopao/\u5475\u5475",
"#[\u54c8\u54c8]":"newpaopao/\u54c8\u54c8","#[\u5410\u820c]":"newpaopao/\u5410\u820c","#[\u592a\u5f00\u5fc3]":"newpaopao/\u592a\u5f00\u5fc3","#[\u7b11\u773c]":"newpaopao/\u7b11\u773c","#[\u82b1\u5fc3]":"newpaopao/\u82b1\u5fc3","#[\u5c0f\u4e56]":"newpaopao/\u5c0f\u4e56","#[\u4e56]":"newpaopao/\u4e56","#[\u6342\u5634\u7b11]":"newpaopao/\u6342\u5634\u7b11","#[\u6ed1\u7a3d]":"newpaopao/\u6ed1\u7a3d","#[\u4f60\u61c2\u7684]":"newpaopao/\u4f60\u61c2\u7684","#[\u4e0d\u9ad8\u5174]":"newpaopao/\u4e0d\u9ad8\u5174",
"#[\u6012]":"newpaopao/\u6012","#[\u6c57]":"newpaopao/\u6c57","#[\u9ed1\u7ebf]":"newpaopao/\u9ed1\u7ebf","#[\u6cea]":"newpaopao/\u6cea","#[\u771f\u68d2]":"newpaopao/\u771f\u68d2","#[\u55b7]":"newpaopao/\u55b7","#[\u60ca\u54ed]":"newpaopao/\u60ca\u54ed","#[\u9634\u9669]":"newpaopao/\u9634\u9669","#[\u9119\u89c6]":"newpaopao/\u9119\u89c6","#[\u9177]":"newpaopao/\u9177","#[\u554a]":"newpaopao/\u554a","#[\u72c2\u6c57]":"newpaopao/\u72c2\u6c57","#[what]":"newpaopao/what","#[\u7591\u95ee]":"newpaopao/\u7591\u95ee",
"#[\u9178\u723d]":"newpaopao/\u9178\u723d","#[\u5440\u54a9\u7239]":"newpaopao/\u5440\u54a9\u7239","#[\u59d4\u5c48]":"newpaopao/\u59d4\u5c48","#[\u60ca\u8bb6]":"newpaopao/\u60ca\u8bb6","#[\u7761\u89c9]":"newpaopao/\u7761\u89c9","#[\u7b11\u5c3f]":"newpaopao/\u7b11\u5c3f","#[\u6316\u9f3b]":"newpaopao/\u6316\u9f3b","#[\u5410]":"newpaopao/\u5410","#[\u7280\u5229]":"newpaopao/\u7280\u5229","#[\u5c0f\u7ea2\u8138]":"newpaopao/\u5c0f\u7ea2\u8138","#[\u61d2\u5f97\u7406]":"newpaopao/\u61d2\u5f97\u7406","#[\u52c9\u5f3a]":"newpaopao/\u52c9\u5f3a",
"#[\u7231\u5fc3]":"newpaopao/\u7231\u5fc3","#[\u5fc3\u788e]":"newpaopao/\u5fc3\u788e","#[\u73ab\u7470]":"newpaopao/\u73ab\u7470","#[\u793c\u7269]":"newpaopao/\u793c\u7269","#[\u5f69\u8679]":"newpaopao/\u5f69\u8679","#[\u592a\u9633]":"newpaopao/\u592a\u9633","#[\u661f\u661f\u6708\u4eae]":"newpaopao/\u661f\u661f\u6708\u4eae","#[\u94b1\u5e01]":"newpaopao/\u94b1\u5e01","#[\u8336\u676f]":"newpaopao/\u8336\u676f","#[\u86cb\u7cd5]":"newpaopao/\u86cb\u7cd5","#[\u5927\u62c7\u6307]":"newpaopao/\u5927\u62c7\u6307",
"#[\u80dc\u5229]":"newpaopao/\u80dc\u5229","#[haha]":"newpaopao/haha","#[OK]":"newpaopao/OK","#[\u6c99\u53d1]":"newpaopao/\u6c99\u53d1","#[\u624b\u7eb8]":"newpaopao/\u624b\u7eb8","#[\u9999\u8549]":"newpaopao/\u9999\u8549","#[\u4fbf\u4fbf]":"newpaopao/\u4fbf\u4fbf","#[\u836f\u4e38]":"newpaopao/\u836f\u4e38","#[\u7ea2\u9886\u5dfe]":"newpaopao/\u7ea2\u9886\u5dfe","#[\u8721\u70db]":"newpaopao/\u8721\u70db","#[\u97f3\u4e50]":"newpaopao/\u97f3\u4e50","#[\u706f\u6ce1]":"newpaopao/\u706f\u6ce1","#(\u9ad8\u5174)":"alu/\u9ad8\u5174",
"#(\u4e0d\u9ad8\u5174)":"alu/\u4e0d\u9ad8\u5174","#(\u76b1\u7709)":"alu/\u76b1\u7709","#(\u90aa\u6076)":"alu/\u90aa\u6076","#(\u5927\u56e7)":"alu/\u5927\u56e7","#(\u60ca\u559c)":"alu/\u60ca\u559c","#(\u5c0f\u773c\u775b)":"alu/\u5c0f\u773c\u775b","#(\u5c0f\u6012)":"alu/\u5c0f\u6012","#(\u65e0\u8bed)":"alu/\u65e0\u8bed","#(\u50bb\u7b11)":"alu/\u50bb\u7b11","#(\u671f\u5f85)":"alu/\u671f\u5f85","#(\u5472\u7259)":"alu/\u5472\u7259","#(\u559c\u6781\u800c\u6ce3)":"alu/\u559c\u6781\u800c\u6ce3","#(\u8138\u7ea2)":"alu/\u8138\u7ea2",
"#(\u4eb2\u4eb2)":"alu/\u4eb2\u4eb2","#(\u72c2\u6c57)":"alu/\u72c2\u6c57","#(\u5f97\u610f)":"alu/\u5f97\u610f","#(\u62a0\u9f3b)":"alu/\u62a0\u9f3b","#(\u62bd\u70df)":"alu/\u62bd\u70df","#(\u5185\u4f24)":"alu/\u5185\u4f24","#(\u53e3\u6c34)":"alu/\u53e3\u6c34","#(\u5410)":"alu/\u5410","#(\u5410\u820c)":"alu/\u5410\u820c","#(\u4e0d\u8bf4\u8bdd)":"alu/\u4e0d\u8bf4\u8bdd","#(\u4e0d\u51fa\u6240\u6599)":"alu/\u4e0d\u51fa\u6240\u6599","#(\u88c5\u5927\u6b3e)":"alu/\u88c5\u5927\u6b3e","#(\u5c34\u5c2c)":"alu/\u5c34\u5c2c",
"#(\u55b7\u6c34)":"alu/\u55b7\u6c34","#(\u55b7\u8840)":"alu/\u55b7\u8840","#(\u54bd\u6c14)":"alu/\u54bd\u6c14","#(\u6124\u6012)":"alu/\u6124\u6012","#(\u8d5e\u4e00\u4e2a)":"alu/\u8d5e\u4e00\u4e2a","#(\u4e2d\u6307)":"alu/\u4e2d\u6307","#(\u770b\u4e0d\u89c1)":"alu/\u770b\u4e0d\u89c1","#(\u65e0\u6240\u8c13)":"alu/\u65e0\u6240\u8c13","#(\u6b22\u547c)":"alu/\u6b22\u547c","#(\u65e0\u5948)":"alu/\u65e0\u5948","#(\u5bb3\u7f9e)":"alu/\u5bb3\u7f9e","#(\u60f3\u4e00\u60f3)":"alu/\u60f3\u4e00\u60f3","#(\u9f13\u638c)":"alu/\u9f13\u638c",
"#(\u89c2\u5bdf)":"alu/\u89c2\u5bdf","#(\u9501\u7709)":"alu/\u9501\u7709","#(\u9ed1\u7ebf)":"alu/\u9ed1\u7ebf","#(\u6c57)":"alu/\u6c57","#(\u54ed\u6ce3)":"alu/\u54ed\u6ce3","#(\u9634\u6697)":"alu/\u9634\u6697","#(\u6697\u5730\u89c2\u5bdf)":"alu/\u6697\u5730\u89c2\u5bdf","#(\u8721\u70db)":"alu/\u8721\u70db","#(\u6295\u964d)":"alu/\u6295\u964d","#(\u5410\u8840\u5012\u5730)":"alu/\u5410\u8840\u5012\u5730","#(\u4fbf\u4fbf)":"alu/\u4fbf\u4fbf","#(\u957f\u8349)":"alu/\u957f\u8349","#(\u80bf\u5305)":"alu/\u80bf\u5305",
"#(\u5750\u7b49)":"alu/\u5750\u7b49","#(\u770b\u70ed\u95f9)":"alu/\u770b\u70ed\u95f9","#(\u6df1\u601d)":"alu/\u6df1\u601d","#(\u732e\u82b1)":"alu/\u732e\u82b1","#(\u732e\u9ec4\u74dc)":"alu/\u732e\u9ec4\u74dc","#(\u4e2d\u67aa)":"alu/\u4e2d\u67aa","#(\u51fb\u638c)":"alu/\u51fb\u638c","#(\u6247\u8033\u5149)":"alu/\u6247\u8033\u5149","#(\u4e2d\u5200)":"alu/\u4e2d\u5200"}),b.reset("\u6ce1\u6ce1")),b.replybox=N,b.el.appendTo(e.body).css({top:N.el.offset().top+N.el.outerHeight()+4+"px",left:N.el.find(".ds-textarea-wrapper").offset().left+
"px"}),k(e.body).click(E)):E(a),!1}),E=(w.find(".ds-add-image").click(function(a){var b=v[0],c=b.value;e.selection?(b.value=c.substring(0,v.data("ds-range-start"))+'<img src="\u8bf7\u8f93\u5165\u56fe\u7247\u5730\u5740" />'+c.substring(v.data("ds-range-end"),c.length),b.value=b.value.replace("\u8bf4\u70b9\u4ec0\u4e48\u5427 ...",""),b.focus(),b=e.selection.createRange(),b.collapse(),b.findText("\u8bf7\u8f93\u5165\u56fe\u7247\u5730\u5740"),b.select()):(b.value=c.substring(0,b.selectionStart)+'<img src="\u8bf7\u8f93\u5165\u56fe\u7247\u5730\u5740" />'+
c.substring(b.selectionEnd),c=b.value.search("\u8bf7\u8f93\u5165\u56fe\u7247\u5730\u5740"),b.setSelectionRange(c,c+7),b.focus());a.preventDefault()}),N.hideSmilies=function(){D.removeClass("ds-expanded");d.smiliesTooltip.el.detach();k(e.body).unbind("click",E)}),J=function(a,b){var c=Q(g["dialog-anonymous"]({services:"weixin weibo qq renren kaixin douban".split(" "),options:r}));if(c.el.find(".ds-dialog").css("width","320px").find(".ds-icons-32 a").click(f),!r.deny_anonymous){var ba=c.el.find("form");
ba.submit(function(){var a=ba.find("input[name=author_email]").val();return!a&&!r.require_guest_email||a.match(/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)?(b(d.toJSON(ba)),c.close(),!1):(alert("\u8bf7\u8f93\u5165\u4e00\u4e2a\u6709\u6548\u7684email\u5730\u5740."),!1)});ba.find("input[name=author_name]")[0].focus()}};r.deny_anonymous&&v.focus(function(){if(M()){J(L,G);var a=function(b){b.stopPropagation();
v.unbind("click",a)};v.click(a)}return!1});var G=function(a){h(L);A.post("posts/create",k.extend(d.toJSON(L),a),function(a){a=H[a.response.post_id]=new ja(a.response);a=S(N.postList,a,r);if("asc"==r.order==("top"==r.formPosition)&&d.scrollTo(a),x.data.comments++,x.updateCounter("duoshuo"),v.val("").trigger("keyup"),qa(L),w.hasClass("ds-inline-replybox")&&(w.detach(),N.actionsBar.removeClass("ds-reply-active")),B)try{B.removeItem("ds_draft_"+x.threadId)}catch(b){}},function(a){qa(L);alert(a.errorMessage)})};
L.submit(function(){if(L.data("submitting"))return!1;var a=k.trim(L[0].message.value);return""==a||!F.placeholder&&a==v.attr("placeholder")?(alert("\u60a8\u8fd8\u6ca1\u5199\u5185\u5bb9\u5462"),!1):(M()?J(L,G):G(),!1)});var K=function(a){return k(a).hasClass("ds-service-icon-grey")?null:k(a).attr("data-service")};if(z.click(function(){return k(this).toggleClass("ds-service-icon-grey").toggleClass("ds-service-icon"),y.value=k.map(z,K).join(","),y.checked=""!=y.value,!1}),k(y).change(function(){var a=
this.checked;z[a?"removeClass":"addClass"]("ds-service-icon-grey")[a?"addClass":"removeClass"]("ds-service-icon");this.value=k.map(z,K).join(",")}),!a&&B){var I="ds_draft_"+x.threadId;v.bind("focus blur keyup",function(a){a=k(a.currentTarget).val();try{B[I]=a}catch(b){}});B[I]&&v.val(B[I])}return this}};m.Dialog=ia.extend({init:function(a,b){(this.el=k("#ds-wrapper"))[0]||(this.el=t(k('<div id="ds-wrapper"></div>')));this.options=k.extend({width:600},b);a!==y&&k(a).attr("id","ds-reset").appendTo(this.el)},
open:function(){function b(a){return 27==a.which?(d.close(),!1):void 0}function c(){return d.close(),!1}var d=this;return d.el.hide().appendTo(e.body).fadeIn(200),F.ie6&&d.el.css("top",la.scrollTop()+100),d.el.show().find(".ds-dialog").delegate("a.ds-dialog-close","click",function(){return d.close(),!1}).click(a),Z.keydown(b),k(e.body).click(c),d.close=function(){Z.unbind("keydown",b);k(e.body).unbind("click",c);d.el.fadeOut(200,function(){k(this).remove()});d.trigger("close")},d}});g.likePanel=function(a){return a.likes?
'<span class="ds-highlight">'+a.likes+"</span> \u4eba\u559c\u6b22":""};m.Meta=function(a){this.embedThread=a};m.Meta.prototype={render:function(){var b=this,c=b.embedThread.model,d=b.el=k(g.meta(c.toJSON())),f=d.find(".ds-like-thread-button");return f.click(function(x){function r(){b.tooltip.detach();k(e.body).unbind("click",r)}function m(a){switch(this.className){case "ds-like-tooltip-close":r(a);break;default:if(!h.open(this.href,"_blank","height=500,width=600,top=0,left=0,toolbar=no,menubar=no,resizable=yes,location=yes,status=no"))return}return!1}
var l=f.hasClass("ds-thread-liked");if(A.post("threads/vote",{thread_id:b.embedThread.threadId,vote:l?0:1},function(a){c.set(a);b.resetLikePanel()}),f.toggleClass("ds-thread-liked"),f.find(".ds-thread-like-text").text(l?"\u559c\u6b22":"\u5df2\u559c\u6b22"),l)return b.tooltip&&r(x),!1;b.tooltip===y&&(x=g.likeTooltip({services:{qzone:"QQ\u7a7a\u95f4",weibo:"\u65b0\u6d6a\u5fae\u535a",qqt:"\u817e\u8baf\u5fae\u535a",renren:"\u4eba\u4eba\u7f51",kaixin:"\u5f00\u5fc3\u7f51",douban:"\u8c46\u74e3\u7f51",baidu:"\u767e\u5ea6\u641c\u85cf"},
thread_id:c.data.thread_id}),b.tooltip=k(x).click(a).delegate("a","click",m));x={};return x.left=0,x.top=d.position().top+d.outerHeight()-4+"px",b.tooltip.appendTo(b.embedThread.innerEl).css(x),k(e.body).click(r),!1}),b.resetLikePanel(),M()&&d.hide(),b},resetLikePanel:function(){this.el.find(".ds-like-panel").html(g.likePanel(this.embedThread.model.toJSON()))}};m.PostListHead=function(a){this.embedThread=a};m.PostListHead.prototype={render:function(){var a=this.embedThread,b=a.postList,c=this.el=
k(g.postListHead({thread:a.model.toJSON(),options:a.options})),d=c.find("ul.ds-comments-tabs");d.delegate(".ds-tab a","click",function(c){d.find("a.ds-current").removeClass("ds-current");b.params.page=1;c=c.currentTarget;switch(c.className){case "ds-comments-tab-duoshuo":b.params.source="duoshuo";a.replybox.el.show();break;case "ds-comments-tab-repost":b.params.source="repost";a.replybox.el.hide();break;case "ds-comments-tab-weibo":b.params.source="weibo";a.replybox.el.hide();break;case "ds-comments-tab-qqt":b.params.source=
"qqt",a.replybox.el.hide()}return k(c).addClass("ds-current"),b.refetch(),!1});var e=c.find(".ds-sort");return e.delegate("a","click",function(){return e.find("a.ds-current").removeClass("ds-current"),b.params.order=a.options.order=this.className.replace("ds-order-",""),b.params.page=1,b.refetch(),k(this).addClass("ds-current"),!1}),e.find(".ds-order-"+b.params.order).addClass("ds-current"),this}};m.Paginator=function(a){a=a||{};var b=this.el=a.el||k('<div class="ds-paginator"></div>'),c=this.collection=
a.collection;b.delegate("a","click",function(){return c.params.page=parseInt(this.innerHTML),c.refetch(),b.find(".ds-current").removeClass("ds-current"),k(this).addClass("ds-current"),!1})};m.Paginator.prototype={reset:function(a){function b(a){e.push('<a data-page="'+a+'" href="javascript:void(0);">'+a+"</a>")}var c,d=this.collection.params.page||1,e=[];if(1<d)for(b(1),c=4<d?d-2:2,2<c&&e.push('<span class="page-break">...</span>');d>c;c++)b(c);if(e.push('<a data-page="'+d+'" href="javascript:void(0);" class="ds-current">'+
d+"</a>"),d<a.pages){for(c=d+1;d+4>=c&&c<a.pages;c++)b(c);c<a.pages&&e.push('<span class="page-break">...</span>');b(a.pages)}this.el.html('<div class="ds-border"></div>'+e.join(" "))[1<a.pages?"show":"hide"]()}};d.addSmilies=function(a,b){var c=d.smiliesTooltip;c&&c.el.find("ul.ds-smilies-tabs").append("<li><a>"+a+"</a></li>");d.smilies[a]=b};m.SmiliesTooltip=function(){};m.SmiliesTooltip.prototype={render:function(){var b=this,c=b.el=k(g.smiliesTooltip(va));return c.click(a).find("ul.ds-smilies-tabs").delegate("a",
"click",function(){b.reset(this.innerHTML)}),c.find(".ds-smilies-container").delegate("img","click",function(){var a=b.replybox,c=a.el.find("textarea"),d=c[0],f=d.value;e.selection?(d.value=f.substring(0,c.data("ds-range-start"))+this.title+f.substring(c.data("ds-range-end"),f.length),d.value=d.value.replace(l.leave_a_message,""),d.focus(),f=e.selection.createRange(),f.moveStart("character",c.data("ds-range-start")+this.title.length),f.collapse(),f.select()):(c=d.selectionStart+this.title.length,
d.value=f.substring(0,d.selectionStart)+this.title+f.substring(d.selectionEnd),d.setSelectionRange(c,c));a.hideSmilies();d.focus()}),this},reset:function(a){var b=this.el.find("ul.ds-smilies-tabs");b.find("a.ds-current").removeClass("ds-current");b.find("a").filter(function(){return this.innerHTML==a}).addClass("ds-current");var c="<ul>";return k.each(va[a],function(b,e){var f=0===a.indexOf("\u5fae\u535a")?"http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/"+e.replace("_org","_thumb"):
d.STATIC_URL+"/images/smilies/"+e;0===a.indexOf("\u6ce1\u6ce1")&&(f="",void 0!=window.devicePixelRatio&&1.49<=window.devicePixelRatio&&(f="@2x"),f="/usr/themes/Leaf/duoshuo/"+e+f+".png");"WordPress"===a&&(b=" "+b+" ");c+='<li><img src="'+f+'" title="'+v(b)+'" height=30 /></li>'}),c+="</ul>",this.el.find(".ds-smilies-container").html(c),this}};g.postPlaceholder=function(){return['<li class="ds-post ds-post-placeholder">',l.no_comments_yet,"</li>"].join("")};var O=k('<div id="ds-bubble"><div class="ds-bubble-content"></div><div class="ds-arrow ds-arrow-down ds-arrow-border"></div><div class="ds-arrow ds-arrow-down"></div></div>'),
ea=O.find(".ds-bubble-content").delegate("a.ds-ctx-open","click",function(){var a={};a.post_id=ea.attr("data-post-id");A.get("posts/conversation",a,function(a){function c(a,b){return g.ctxPost({post:a,index:b})}D.log(k.map(a.response,c).join("\n"));b.el.find("ol");b.el.find("ol").html(k.map(a.response,c).join("\n"))});var b=Q('<h2>\u67e5\u770b\u5bf9\u8bdd</h2><ol id="ds-ctx"></ol>');return b.el.find(".ds-dialog").css("width","600px"),b.el.find(".ds-dialog-body").css({"max-height":"350px",_height:"350px",
"overflow-y":"auto","padding-top":"10px"}),!1}),da=bubbleOutTimer=0;O.mouseenter(W).mouseleave(X);m.PostList=function(a){a&&(a.params&&(this.params=a.params),a.embedThread&&(this.embedThread=a.embedThread));this.el=k('<ul class="ds-comments"></ul>')};m.PostList.prototype={url:"threads/listPosts",render:function(){return Y.call(this.el,this.embedThread,this.embedThread.options),this},reset:function(a){var b=this.embedThread.options;this.el.html(a[0]?k.map(H.getJSON(a),function(a){return g.post({post:a,
options:b})}).join(""):g.postPlaceholder())},refetch:function(){var a=this,b=k(g.indicator()).appendTo(e.body).fadeIn(200);a.el.fadeTo(200,.5);A.get(a.url,a.params,function(c){H.set(c.parentPosts||c.relatedPosts);K.set(c.users);a.reset(c.response);a.embedThread.paginator.reset(c.cursor);a.el.fadeTo(200,1);d.scrollTo(a.el);b.remove()})}};m.RelatedRead=function(){this._init()};m.RelatedRead.prototype={_init:function(){this.el=k('<div id="ds-related-reads"></div>')},load:function(a){h.__duoshuo_id__=
a;h.readsByToutiao=[];h.readsByToutiao.push({id:"ds-related-reads",num:3});a=e.createElement("script");a.src="//s0.pstatp.com/site/reads-sdk/5bf3702b38076207bee1.js";a.charset="utf-8";a.crossOrigin="anonymous";e.head.appendChild(a)},mount:function(a){this.el.insertBefore(a)}};m.EmbedThread=G.extend({uri:"threads/listPosts",params:"thread-id local-thread-id source-thread-id thread-key category channel-key author-key author-id url limit order max-depth form-position container-url"+(ma.match(/MSIE 6\.0/)?
"":" title image thumbnail"),render:function(){var a=this.el;if("\u8bf7\u5c06\u6b64\u5904\u66ff\u6362\u6210\u6587\u7ae0\u5728\u4f60\u7684\u7ad9\u70b9\u4e2d\u7684ID"===a.data("thread-key"))return alert("\u8bf7\u8bbe\u7f6e\u6b63\u786e\u7684 data-thread-key \u5c5e\u6027"),!1;a.attr("id","ds-thread").append(g.waitingImg());var b=a.width(),c=a.data("url")||!a.attr("data-thread-id")&&k("link[rel=canonical]").attr("href");c?a.data("url",Aa(c)):a.data("container-url",P.href);b&&400>=b&&a.addClass("ds-narrow").data("max-depth",
1)},updateCounter:function(a){function b(a){return a.substr(a.indexOf("}")+1)}var c={duoshuo:["comments",b(l.comments_multiple)||"\u8bc4\u8bba"],repost:["reposts",b(l.reposts_multiple)||"\u8f6c\u8f7d"],weibo:["weibo_reposts",b(l.weibo_reposts_multiple)||"\u65b0\u6d6a\u5fae\u535a"],qqt:["qqt_reposts",b(l.qqt_reposts_multiple)||"\u817e\u8baf\u5fae\u535a"]},d;for(d in c)if(!a||a==d){var e=this.data[c[d][0]];this.el.find(".ds-comments-tab-"+d).html(this.el.hasClass("ds-narrow")?'<span class="ds-highlight">'+
e+"</span>"+c[d][1]:(e?'<span class="ds-highlight">'+e+"</span>":"0")+c[d][1])}},onError:function(a){this.el.html("\u8bc4\u8bba\u6846\u51fa\u9519\u5566("+a.code+"): "+a.errorMessage)},onload:function(a){var b=this,c=b.threadId=a.thread.thread_id,e=a.cursor,l=b.options=a.options,r=b.innerEl=t(k('<div id="ds-reset"></div>').appendTo(b.el));b.model=new pa(b.data=a.thread);H.set(a.parentPosts||a.relatedPosts);K.set(a.users);b.el.find("#ds-waiting").remove();a.options&&a.options.show_recommend&&(b.relatedRead=
new m.RelatedRead,b.relatedRead.load(a.thread.site_id),b.relatedRead.mount(r));l.like_thread_enabled&&(b.meta=new m.Meta(b),r.append(b.meta.render().el));l.hot_posts&&a.hotPosts&&a.hotPosts.length&&(b.hotPosts=new m.HotPosts(k('<div class="ds-rounded"></div>'),{max_depth:1,show_context:l.show_context}),b.hotPosts.thread=b,r.append(b.hotPosts.el),b.hotPosts.onload({list:H.getJSON(a.hotPosts)}));b.postListHead=new m.PostListHead(b);b.postList=new m.PostList({embedThread:b,params:{source:"duoshuo",thread_id:c,
max_depth:l.max_depth,order:l.order,limit:l.limit}});b.postList.render().reset(a.response);b.paginator=new m.Paginator({collection:b.postList});b.paginator.reset(e);c=b.replybox=new m.Replybox(b);c.postList=b.postList.el;M()?b.loginButtons=k(g.loginButtons()).delegate("a.ds-more-services","click",function(){return b.loginButtons.find(".ds-additional-services").toggle(),!1}).delegate("a.ds-service-link","click",f):b.toolbar=k(g.toolbar()).delegate(".ds-account-control","mouseenter",function(){k(this).addClass("ds-active")}).delegate(".ds-account-control",
"mouseleave",function(){k(this).removeClass("ds-active")}).delegate("a.ds-bind-more","click",function(){return Q(g["dialog-bind-more"]()).el.find(".ds-dialog").addClass("ds-dialog-bind-more").css("width","300px").find("a.ds-service-link").click(f),!1}).delegate("a.ds-unread-comments-count","click",function(){return V("unread-comments"),!1});e=['<a name="respond"></a>',b.toolbar||b.loginButtons,c.render().el];"top"==l.formPosition&&k.fn.append.apply(r,e);r.append(b.postListHead.render().el,b.postList.el,
b.paginator.el);"bottom"==l.formPosition&&k.fn.append.apply(r,e);r.append(g.poweredBy(l.poweredby_text));b.updateCounter();a.alerts&&k.each(a.alerts,function(a,c){k('<div class="ds-alert">'+c+"</div>").insertBefore(b.toolbar||loginButtons)});l.message&&c.el.find("textarea").val(l.message).focus();J.on("reset",function(){var a=J.data.comments||0;r.find("a.ds-unread-comments-count").html(a).attr("title",a?"\u4f60\u6709"+a+"\u6761\u65b0\u56de\u590d":"\u4f60\u6ca1\u6709\u65b0\u56de\u590d").css("display",
a?"inline":"none")});l.mzadx_id&&(d.require("mzadxN",function(){}),k('<div id="MZADX_'+l.mzadx_id+'" style="margin:0 auto;"></div>').appendTo(r),__mz_rpq=h.__mz_rpq||[],__mz_rpq.push({l:[l.mzadx_id],r:"1",_srv:"MZADX",_callback:function(){}}));d.thread=b;J.data!==y&&J.trigger("reset");M()||xa.send({visit_thread_id:b.threadId})},onMessage:function(a){S(this.postList.el,new ja(a),this.options)}});m.HotPosts=G.extend({tmpl:"hotPosts",params:"show-quote",render:function(){return this.el.attr("id","ds-hot-posts"),
this},onload:function(a){a.options=k.extend(this.options,a.options);G.prototype.onload.call(this,a);Y.call(this.el.find("ul"),this.thread,this.options)}});m.RecentComments=G.extend({tmpl:"commentList",uri:"sites/listRecentPosts",params:"show-avatars show-time show-title avatar-size show-admin excerpt-length num-items channel-key",render:function(){this.el.attr("id","ds-recent-comments")},prepare:function(a){return{list:k.map(a.response,function(a){return(new ja(a)).toJSON()})}}});m.RecentVisitors=
G.extend({tmpl:"recentVisitors",uri:"sites/listVisitors",params:"show-time avatar-size num-items channel-key",render:function(){this.el.children().detach();this.el.attr("id","ds-recent-visitors").append(this.waitingEl=k(g.waitingImg()))}});m.TopThreads=G.extend({tmpl:"topThreads",uri:"sites/listTopThreads",params:"range num-items channel-key",render:function(){this.el.children().detach();this.el.attr("id","ds-top-threads").append(this.waitingEl=k(g.waitingImg()))}});m.LoginWidget=G.extend({tmpl:"loginWidget",
render:function(){var a=this.el;a.attr("id","ds-login").html(g.loginWidget("weixin weibo qq renren kaixin douban".split(" ")));a.find("a").click(f);a.find("a.ds-logout").attr("href",E.logoutUrl())}});m.ThreadCount=G.extend({onload:function(a){var b=this.el,c=b.data("count-type")||"comments";a=a.data[c];b[b.data("replace")?"replaceWith":"html"](l[c+"_"+(a?1<a?"multiple":"one":"zero")].replace("{num}",a))}});m.ShareWidget=G.extend({tmpl:"shareWidget",render:function(){var a={copyright:"\u591a\u8bf4\u5206\u4eab\u63d2\u4ef6",
services:"weibo qzone sohu renren netease qqt kaixin douban qq meilishuo mogujie baidu taobao google wechat diandian huaban duitang youdao pengyou facebook twitter linkedin msn".split(" ")};this.el.attr("id","ds-share");this.el.children().attr("id","ds-reset");this.el.find(".ds-share-aside-inner").html(g.shareWidget(a));this.el.find(".ds-share-icons-more").html(g.shareWidget(a));this.el.find(".ds-share-icons-more").hide();this.el.hasClass("flat")&&this.el.find("a").each(function(){k(this).addClass("flat")});
t(this.el);this.delegateEvents()},delegateEvents:function(){var a=this.el;if(a.children().hasClass("ds-share-inline")){var b=a.find(".ds-share-icons-more");a.delegate("[data-toggle=ds-share-icons-more]","mouseover",function(){b.show()});a.delegate("[data-toggle=ds-share-icons-more]","mouseout",function(){b.hide()});a.delegate(".ds-share-icons-more","mouseover",function(){b.show()});a.delegate(".ds-share-icons-more","mouseout",function(){b.hide()})}else{var c=a.children().hasClass("ds-share-aside-left")?
"slide-to-right":"slide-to-left",d=a.children();if(!p.cssProperty("transition")){var f=a.children().hasClass("ds-share-aside-left")?"left":"right";a.delegate(".ds-share-aside-toggle","mouseover",function(){var a={};F.ie6&&"right"===f?a.left=(e.documentElement.scrollLeft+e.documentElement.clientWidth-this.offsetWidth-(parseInt(this.currentStyle.marginLeft,10)||0)-parseInt(this.currentStyle.marginRight,10)||0)-195:a[f]=0;d.animate(a,200)});a.delegate(".ds-share-aside-inner","mouseleave",function(){var a=
{};F.ie6&&"right"===f?a.left=(e.documentElement.scrollLeft+e.documentElement.clientWidth-this.offsetWidth-(parseInt(this.currentStyle.marginLeft,10)||0)-parseInt(this.currentStyle.marginRight,10)||0)+230:a[f]=-229;d.animate(a,200)})}a.delegate(".ds-share-aside-toggle,.ds-share-aside-inner","mouseover",function(){d.addClass(c)});a.delegate(".ds-share-aside-toggle,.ds-share-aside-inner","mouseleave",function(){d.removeClass(c)})}a.delegate("a","click",function(b){var c=k(this).data("service");if(!a.data("url"))return void alert("\u8bf7\u8bbe\u7f6edata-url");
if("wechat"===c){var c=z()+"/api/qrcode/getImage.png",d="?size=240&text="+a.data("url");Q(g["dialog-qrcode"]({qrcode_url:c+d,url:a.data("url")})).el.find(".ds-dialog").css("width","320px")}else c=z()+"/share-proxy/?"+p.param({service:k(this).data("service"),thread_key:a.data("threadKey"),title:a.data("title"),images:a.data("images"),content:a.data("content"),url:a.data("url")}),h.open(c,"_blank");b.preventDefault();b.stopPropagation()})}});var aa=0;d.initSelector=function(a,b){function c(a){ha(a);
p.extend(l,a.options);ka.set(a.response)}var d=[];!na()||!k.isReady&&Ba||k(a).each(function(a,c){var e=k(c);if(!e.data("initialized")){e.data("initialized",!0);var f=new m[b.type](e,b);if(Ca.push(f),"ThreadCount"===b.type){var g=e.attr("data-thread-key");e.attr("data-channel-key")&&(g=e.attr("data-channel-key")+":"+g);d.push(g);ka[g]||(ka[g]=new pa({}));ka[g].on("reset",function(){f.onload(this)})}else if(f.uri){var h={};k.each(f.params.split(" "),function(a,b){h[b.replace(/-/g,"_")]=e.attr("data-"+
b)||e.data(b)});A.get(f.uri,fa(h),function(a){f.load(a)})}}});d.length&&A.get("threads/counts",fa({threads:d.join(",")}),c)};(d.initView=function(){k.each(ca,d.initSelector)})();k(function(){if(!n){if(!na())return D.error("\u7f3a\u5c11 duoshuoQuery \u7684\u5b9a\u4e49");D.warn("\u8bf7\u5728\u52a0\u8f7d\u591a\u8bf4 embed.js \u4e4b\u524d\u5b9a\u4e49 duoshuoQuery")}setInterval(function(){k(".ds-time").each(function(){var a=k(this).attr("datetime");a&&(this.innerHTML=d.elapsedTime(a))})},2E4);n.ondomready&&
n.ondomready();d.initView();!aa&&n.short_name&&A.get("analytics/ping",fa({}),ha)})})}}(window,document);